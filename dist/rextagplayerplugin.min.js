!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rextagplayerplugin=e();}(undefined,(function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(s=n.key,a=void 0,"symbol"==typeof(a=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return ("string"===e?String:Number)(t)}(s,"string"))?a:String(a)),n);}var s,a;}function n(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e);}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return !1}}();return function(){var i,n=a(t);if(e){var s=a(this).constructor;i=Reflect.construct(n,arguments,s);}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return o(t)}(this,i)}}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}(t,e);if(n){var s=Object.getOwnPropertyDescriptor(n,e);return s.get?s.get.call(arguments.length<3?t:i):s.value}},c.apply(this,arguments)}function h(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var f=Phaser.Scene,d=function(t){return t instanceof f},p={setEventEmitter:function(t,e){return void 0===e&&(e=Phaser.Events.EventEmitter),this._privateEE=!0===t||void 0===t,this._eventEmitter=this._privateEE?new e:t,this},destroyEventEmitter:function(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter:function(){return this._eventEmitter},on:function(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function(t){return this._eventEmitter&&t&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]},eventNames:function(){return this._eventEmitter?this._eventEmitter.eventNames.apply(this._eventEmitter,arguments):[]}},g=function(e){return null==e||"object"!==t(e)?null:d(e)?e:e.scene&&d(e.scene)?e.scene:e.parent&&e.parent.scene&&d(e.parent.scene)?e.parent.scene:null},m=Phaser.Game,v=function(t){return t instanceof m},y=Phaser.Utils.Objects.GetValue,k=function(){function i(t,n){e(this,i),this.setParent(t),this.isShutdown=!1,this.setEventEmitter(y(n,"eventEmitter",!0)),this.parent&&(this.parent===this.scene?this.scene.sys.events.once("shutdown",this.onEnvDestroy,this):this.parent===this.game?this.game.events.once("shutdown",this.onEnvDestroy,this):this.parent.once&&this.parent.once("destroy",this.onParentDestroy,this));}return n(i,[{key:"shutdown",value:function(t){this.isShutdown||(this.parent&&(this.parent===this.scene?this.scene.sys.events.off("shutdown",this.onEnvDestroy,this):this.parent===this.game?this.game.events.off("shutdown",this.onEnvDestroy,this):this.parent.once&&this.parent.off("destroy",this.onParentDestroy,this)),this.destroyEventEmitter(),this.parent=void 0,this.scene=void 0,this.game=void 0,this.isShutdown=!0);}},{key:"destroy",value:function(t){this.shutdown(t);}},{key:"onEnvDestroy",value:function(){this.destroy(!0);}},{key:"onParentDestroy",value:function(t,e){this.destroy(e);}},{key:"setParent",value:function(e){var i;return this.parent=e,this.scene=g(e),this.game=null==(i=e)||"object"!==t(i)?null:v(i)?i:v(i.game)?i.game:d(i)?i.sys.game:d(i.scene)?i.scene.sys.game:void 0,this}}]),i}();Object.assign(k.prototype,p);var b=Phaser.Utils.Objects.GetValue,E=function(t){s(r,t);var i=u(r);function r(t,n){var s;return e(this,r),(s=i.call(this,t,n))._isRunning=!1,s.isPaused=!1,s.tickingState=!1,s.setTickingMode(b(n,"tickingMode",1)),s}return n(r,[{key:"boot",value:function(){2!==this.tickingMode||this.tickingState||this.startTicking();}},{key:"shutdown",value:function(t){this.isShutdown||(this.stop(),this.tickingState&&this.stopTicking(),c(a(r.prototype),"shutdown",this).call(this,t));}},{key:"setTickingMode",value:function(t){"string"==typeof t&&(t=M[t]),this.tickingMode=t;}},{key:"startTicking",value:function(){this.tickingState=!0;}},{key:"stopTicking",value:function(){this.tickingState=!1;}},{key:"isRunning",get:function(){return this._isRunning},set:function(t){this._isRunning!==t&&(this._isRunning=t,1===this.tickingMode&&t!=this.tickingState&&(t?this.startTicking():this.stopTicking()));}},{key:"start",value:function(){return this.isPaused=!1,this.isRunning=!0,this}},{key:"pause",value:function(){return this.isRunning&&(this.isPaused=!0,this.isRunning=!1),this}},{key:"resume",value:function(){return this.isPaused&&(this.isRunning=!0),this}},{key:"stop",value:function(){return this.isPaused=!1,this.isRunning=!1,this}},{key:"complete",value:function(){this.isPaused=!1,this.isRunning=!1,this.emit("complete",this.parent,this);}}]),r}(k),M={no:0,lazy:1,always:2},w=Phaser.Utils.Objects.GetValue,T=function(t){s(r,t);var i=u(r);function r(t,n){var s;e(this,r);var a=(s=i.call(this,t,n)).scene?"update":"step";return s.tickEventName=w(n,"tickEventName",a),s.isSceneTicker=!O(s.tickEventName),s}return n(r,[{key:"startTicking",value:function(){c(a(r.prototype),"startTicking",this).call(this),this.isSceneTicker?this.scene.sys.events.on(this.tickEventName,this.update,this):this.game.events.on(this.tickEventName,this.update,this);}},{key:"stopTicking",value:function(){c(a(r.prototype),"stopTicking",this).call(this),this.isSceneTicker&&this.scene?this.scene.sys.events.off(this.tickEventName,this.update,this):this.game&&this.game.events.off(this.tickEventName,this.update,this);}}]),r}(E),O=function(t){return "step"===t||"poststep"===t},S=Phaser.Utils.Objects.GetValue,j=Phaser.Math.Clamp,C=function(){function t(i){e(this,t),this.resetFromJSON(i);}return n(t,[{key:"resetFromJSON",value:function(t){this.state=S(t,"state",P),this.timeScale=S(t,"timeScale",1),this.delay=S(t,"delay",0),this.repeat=S(t,"repeat",0),this.repeatCounter=S(t,"repeatCounter",0),this.repeatDelay=S(t,"repeatDelay",0),this.duration=S(t,"duration",0),this.nowTime=S(t,"nowTime",0),this.justRestart=S(t,"justRestart",!1);}},{key:"toJSON",value:function(){return {state:this.state,timeScale:this.timeScale,delay:this.delay,repeat:this.repeat,repeatCounter:this.repeatCounter,repeatDelay:this.repeatDelay,duration:this.duration,nowTime:this.nowTime,justRestart:this.justRestart}}},{key:"destroy",value:function(){}},{key:"setTimeScale",value:function(t){return this.timeScale=t,this}},{key:"setDelay",value:function(t){return void 0===t&&(t=0),this.delay=t,this}},{key:"setDuration",value:function(t){return this.duration=t,this}},{key:"setRepeat",value:function(t){return this.repeat=t,this}},{key:"setRepeatInfinity",value:function(){return this.repeat=-1,this}},{key:"setRepeatDelay",value:function(t){return this.repeatDelay=t,this}},{key:"start",value:function(){return this.nowTime=this.delay>0?-this.delay:0,this.state=this.nowTime>=0?G:x,this.repeatCounter=0,this}},{key:"stop",value:function(){return this.state=P,this}},{key:"update",value:function(t,e){this.state!==P&&this.state!==R&&0!==e&&0!==this.timeScale&&(this.nowTime+=e*this.timeScale,this.justRestart=!1,this.nowTime>=this.duration?-1===this.repeat||this.repeatCounter<this.repeat?(this.repeatCounter++,this.justRestart=!0,this.nowTime-=this.duration,this.repeatDelay>0&&(this.nowTime-=this.repeatDelay,this.state=B)):(this.nowTime=this.duration,this.state=R):this.nowTime>=0&&(this.state=G));}},{key:"t",get:function(){var t;switch(this.state){case P:case x:case B:t=0;break;case G:t=this.nowTime/this.duration;break;case R:t=1;}return j(t,0,1)},set:function(t){(t=j(t,-1,1))<0?(this.state=x,this.nowTime=-this.delay*t):(this.state=G,this.nowTime=this.duration*t,1===t&&0!==this.repeat&&this.repeatCounter++);}},{key:"setT",value:function(t){return this.t=t,this}},{key:"isIdle",get:function(){return this.state===P}},{key:"isDelay",get:function(){return this.state===x}},{key:"isCountDown",get:function(){return this.state===G}},{key:"isRunning",get:function(){return this.state===x||this.state===G}},{key:"isDone",get:function(){return this.state===R}},{key:"isOddIteration",get:function(){return 1==(1&this.repeatCounter)}},{key:"isEvenIteration",get:function(){return 0==(1&this.repeatCounter)}}]),t}(),P=0,x=1,G=2,B=3,R=-1,D=function(t){s(r,t);var i=u(r);function r(t,n){var s;return e(this,r),(s=i.call(this,t,n)).timer=new C,s}return n(r,[{key:"shutdown",value:function(t){this.isShutdown||(c(a(r.prototype),"shutdown",this).call(this,t),this.timer.destroy(),this.timer=void 0);}},{key:"start",value:function(){return this.timer.start(),c(a(r.prototype),"start",this).call(this),this}},{key:"stop",value:function(){return this.timer.stop(),c(a(r.prototype),"stop",this).call(this),this}},{key:"complete",value:function(){return this.timer.stop(),c(a(r.prototype),"complete",this).call(this),this}}]),r}(T),F=Phaser.Utils.Objects.GetValue,_=Phaser.Utils.Objects.GetAdvancedValue,V=Phaser.Tweens.Builders.GetEaseFunction,L=function(t){s(r,t);var i=u(r);function r(){return e(this,r),i.apply(this,arguments)}return n(r,[{key:"resetFromJSON",value:function(t){return this.timer.resetFromJSON(F(t,"timer")),this.setEnable(F(t,"enable",!0)),this.setTarget(F(t,"target",this.parent)),this.setDelay(_(t,"delay",0)),this.setDuration(_(t,"duration",1e3)),this.setEase(F(t,"ease","Linear")),this.setRepeat(F(t,"repeat",0)),this}},{key:"setEnable",value:function(t){return null==t&&(t=!0),this.enable=t,this}},{key:"setTarget",value:function(t){return void 0===t&&(t=this.parent),this.target=t,this}},{key:"setDelay",value:function(t){return this.delay=t,this}},{key:"setDuration",value:function(t){return this.duration=t,this}},{key:"setRepeat",value:function(t){return this.repeat=t,this}},{key:"setRepeatDelay",value:function(t){return this.repeatDelay=t,this}},{key:"setEase",value:function(t){return void 0===t&&(t="Linear"),this.ease=t,this.easeFn=V(t),this}},{key:"start",value:function(){return this.timer.isRunning||c(a(r.prototype),"start",this).call(this),this}},{key:"restart",value:function(){return this.timer.stop(),this.start.apply(this,arguments),this}},{key:"stop",value:function(t){return void 0===t&&(t=!1),c(a(r.prototype),"stop",this).call(this),t&&(this.timer.setT(1),this.updateGameObject(this.target,this.timer),this.complete()),this}},{key:"update",value:function(t,e){if(!this.isRunning||!this.enable||!this.parent.active)return this;var i=this.target,n=this.timer;return n.update(t,e),n.isDelay||this.updateGameObject(i,n),this.emit("update",i,this),n.isDone&&this.complete(),this}},{key:"updateGameObject",value:function(t,e){}}]),r}(D),I=Phaser.Sound.BaseSound,A=function(t){return t instanceof I},W=Phaser.Utils.Objects.GetValue,N=Phaser.Utils.Objects.GetAdvancedValue,U=Phaser.Math.Linear,J=function(t){s(r,t);var i=u(r);function r(t,n,s){var a;return e(this,r),A(t)&&(s=n,n=t,t=void 0),n.active=!0,n.scene=t,n.game=n.manager.game,(a=i.call(this,n,s)).volume={},a.resetFromJSON(s),a}return n(r,[{key:"resetFromJSON",value:function(t){return c(a(r.prototype),"resetFromJSON",this).call(this,t),this.setMode(W(t,"mode",0)),this.setEnable(W(t,"enable",!0)),this.setVolumeRange(N(t,"volume.start",this.parent.volume),N(t,"volume.end",0)),this}},{key:"setMode",value:function(t){return "string"==typeof t&&(t=z[t]),this.mode=t,this}},{key:"setVolumeRange",value:function(t,e){return this.volume.start=t,this.volume.end=e,this}},{key:"start",value:function(){return this.timer.isRunning||(this.parent.setVolume(this.volume.start),this.timer.setDelay(this.delay).setDuration(this.duration),c(a(r.prototype),"start",this).call(this)),this}},{key:"updateGameObject",value:function(t,e){t.volume=U(this.volume.start,this.volume.end,e.t);}},{key:"complete",value:function(){switch(c(a(r.prototype),"complete",this).call(this),this.mode){case 1:this.parent.stop();break;case 2:this.parent.destroy();}return this}}]),r}(L),z={stop:1,destroy:2},X=function(t,e,i,n,s){A(t)&&(s=n,n=i,i=e,e=t,t=void 0),void 0===n&&(n=1),void 0===s&&(s=0);var a,r={mode:0,volume:{start:s,end:n},duration:i};return "string"==typeof e&&(e=t.sys.sound.add(e)),e.hasOwnProperty("_fade")?(a=e._fade).stop().resetFromJSON(r):(a=new J(t,e,r),e._fade=a),a.start(),e.isPlaying||e.setVolume(s).play(),e},Y=function(t,e,i,n){A(t)&&(n=i,i=e,e=t,t=void 0),void 0===n&&(n=!0);var s,a={mode:n?2:1,volume:{start:e.volume,end:0},duration:i};return e.hasOwnProperty("_fade")?(s=e._fade).stop().resetFromJSON(a):(s=new J(t,e,a),e._fade=s),s.start(),e.isPlaying||e.play(),e},K={setBackgroundMusicLoopValue:function(t){return this.backgroundMusicLoopValue=t,this},setBackgroundMusicFadeTime:function(t){return this.backgroundMusicFadeTime=t,this},getBackgroundMusic:function(){return this.backgroundMusic},setCurrentBackgroundMusic:function(t){return this.backgroundMusic=t,t&&(t.setLoop(this.backgroundMusicLoopValue),t.once("complete",(function(){this.backgroundMusic===t&&(this.backgroundMusic.destroy(),this.backgroundMusic=void 0);}),this).once("destroy",(function(){this.backgroundMusic===t&&(this.backgroundMusic=void 0);}),this),t.isPlaying||t.play()),this},playBackgroundMusic:function(t){return this.backgroundMusic&&this.backgroundMusic.key===t||(this.stopBackgroundMusic(),this.setCurrentBackgroundMusic(this.sound.add(t)),this.backgroundMusicFadeTime>0&&this.fadeInBackgroundMusic(this.backgroundMusicFadeTime)),this},pauseBackgroundMusic:function(){return this.backgroundMusic&&this.backgroundMusic.pause(),this},resumeBackgroundMusic:function(){return this.backgroundMusic&&this.backgroundMusic.resume(),this},stopBackgroundMusic:function(){return this.backgroundMusic&&(this.backgroundMusicFadeTime>0?this.fadeOutBackgroundMusic(this.backgroundMusicFadeTime,!0):(this.backgroundMusic.stop(),this.backgroundMusic.destroy(),this.backgroundMusic=void 0)),this},fadeInBackgroundMusic:function(t){return this.backgroundMusic&&X(this.backgroundMusic,t,this.backgroundMusicVolume,0),this},fadeOutBackgroundMusic:function(t,e){return this.backgroundMusic&&Y(this.backgroundMusic,t,e),this},crossFadeBackgroundMusic:function(t,e){var i=this.backgroundMusicFadeTime;return this.backgroundMusicFadeTime=0,this.fadeOutBackgroundMusic(e,!0).playBackgroundMusic(t).fadeInBackgroundMusic(e),this.backgroundMusicFadeTime=i,this},setBackgroundMusicVolume:function(t){return this.backgroundMusicVolume=t,this}},$={setBackgroundMusic2LoopValue:function(t){return this.backgroundMusic2LoopValue=t,this},setBackgroundMusic2FadeTime:function(t){return this.backgroundMusic2FadeTime=t,this},getBackgroundMusic2:function(){return this.backgroundMusic2},setCurrentBackgroundMusic2:function(t){return this.backgroundMusic2=t,t&&(t.setLoop(this.backgroundMusic2LoopValue),t.once("complete",(function(){this.backgroundMusic2===t&&(this.backgroundMusic2.destroy(),this.backgroundMusic2=void 0);}),this).once("destroy",(function(){this.backgroundMusic2===t&&(this.backgroundMusic2=void 0);}),this),t.isPlaying||t.play()),this},playBackgroundMusic2:function(t){return this.backgroundMusic2&&this.backgroundMusic2.key===t||(this.stopBackgroundMusic2(),this.setCurrentBackgroundMusic2(this.sound.add(t)),this.backgroundMusic2FadeTime>0&&this.fadeInBackgroundMusic2(this.backgroundMusic2FadeTime)),this},pauseBackgroundMusic2:function(){return this.backgroundMusic2&&this.backgroundMusic2.pause(),this},resumeBackgroundMusic2:function(){return this.backgroundMusic2&&this.backgroundMusic2.resume(),this},stopBackgroundMusic2:function(){return this.backgroundMusic2&&(this.backgroundMusic2FadeTime>0?this.fadeOutBackgroundMusic2(this.backgroundMusic2FadeTime,!0):(this.backgroundMusic2.stop(),this.backgroundMusic2.destroy(),this.backgroundMusic2=void 0)),this},fadeInBackgroundMusic2:function(t){return this.backgroundMusic2&&X(this.backgroundMusic2,t,this.backgroundMusic2Volume,0),this},fadeOutBackgroundMusic2:function(t,e){return this.backgroundMusic2&&Y(this.backgroundMusic2,t,e),this},crossFadeBackgroundMusic2:function(t,e){var i=this.backgroundMusic2FadeTime;return this.backgroundMusic2FadeTime=0,this.fadeOutBackgroundMusic2(e,!0).playBackgroundMusic2(t).fadeInBackgroundMusic2(e),this.backgroundMusic2FadeTime=i,this},setBackgroundMusic2Volume:function(t){return this.backgroundMusic2Volume=t,this}},H=Phaser.Utils.Array.Remove,q={getSoundEffects:function(){return this.soundEffects},getLastSoundEffect:function(){return this.soundEffects[this.soundEffects.length-1]},playSoundEffect:function(t){var e=this.sound.add(t);return e.setVolume(this.soundEffectsVolume),this.soundEffects.push(e),e.once("complete",(function(){e.destroy(),this.sound&&H(this.soundEffects,e);}),this).once("destroy",(function(){this.sound&&H(this.soundEffects,e);}),this).play(),this},fadeInSoundEffect:function(t){var e=this.getLastSoundEffect();return e&&X(e,t,this.soundEffectsVolume,0),this},fadeOutSoundEffect:function(t,e){var i=this.getLastSoundEffect();return i&&Y(i,t,e),this},fadeOutAllSoundEffects:function(t,e){for(var i=this.soundEffects.length-1;i>=0;i--)Y(this.soundEffects[i],t,e);return this},setSoundEffectVolume:function(t,e){if(void 0===e&&(e=!1),e){var i=this.getLastSoundEffect();i&&i.setVolume(t);}else this.soundEffectsVolume=t;return this}},Z=Phaser.Utils.Array.Remove,Q={getSoundEffects2:function(){return this.soundEffects2},getLastSoundEffect2:function(){return this.soundEffects2[this.soundEffects2.length-1]},playSoundEffect2:function(t){var e=this.sound.add(t);return e.setVolume(this.soundEffects2Volume),this.soundEffects2.push(e),e.once("complete",(function(){e.destroy(),this.sound&&Z(this.soundEffects2,e);}),this).once("destroy",(function(){this.sound&&Z(this.soundEffects2,e);}),this).play(),this},fadeInSoundEffect2:function(t){var e=this.getLastSoundEffect2();return e&&X(e,t,this.soundEffects2Volume,0),this},fadeOutSoundEffect2:function(t,e){var i=this.getLastSoundEffect2();return i&&Y(i,t,e),this},fadeOutAllSoundEffects2:function(t,e){for(var i=this.soundEffects2.length-1;i>=0;i--)Y(this.soundEffects2[i],t,e);return this},setSoundEffect2Volume:function(t,e){if(void 0===e&&(e=!1),e){var i=this.getLastSoundEffect2();i&&i.setVolume(t);}else this.soundEffects2Volume=t;return this}},tt={};Object.assign(tt,K,$,q,Q);var et=Phaser.Utils.Objects.GetValue,it=function(){function t(i,n){e(this,t),this.sound=function(t){return d(t)?t.sys.sound:t.sound}(i),this.backgroundMusic=void 0,this._backgroundMusicVolume=et(n,"bgm.volume",1),this.setBackgroundMusicLoopValue(et(n,"bgm.loop",!0)),this.setBackgroundMusicFadeTime(et(n,"bgm.fade",500)),this.backgroundMusic2=void 0,this._backgroundMusic2Volume=et(n,"bgm2.volume",1),this.setBackgroundMusic2LoopValue(et(n,"bgm2.loop",!0)),this.setBackgroundMusic2FadeTime(et(n,"bgm2.fade",500)),this.soundEffects=[],this._soundEffectsVolume=et(n,"soundEffect.volume",1),this.soundEffects2=[],this._soundEffects2Volume=et(n,"soundEffect2.volume",1);var s=et(n,"bgm.initial",void 0);s&&this.setCurrentBackgroundMusic(s);var a=et(n,"bgm2.initial",void 0);a&&this.setCurrentBackgroundMusic2(a);}return n(t,[{key:"destroy",value:function(){if(this.backgroundMusic&&this.backgroundMusic.destroy(),this.backgroundMusic=void 0,this.backgroundMusic2&&this.backgroundMusic2.destroy(),this.backgroundMusic2=void 0,this.soundEffects.length)for(var t=this.soundEffects.length-1;t>=0;t--)this.soundEffects[t].destroy();if(this.soundEffects.length=0,this.soundEffects2.length)for(t=this.soundEffects2.length-1;t>=0;t--)this.soundEffects2[t].destroy();return this.soundEffects2.length=0,this.sound=void 0,this}},{key:"backgroundMusicVolume",get:function(){return this._backgroundMusicVolume},set:function(t){this._backgroundMusicVolume=t,this.backgroundMusic&&this.backgroundMusic.setVolume(t);}},{key:"backgroundMusic2Volume",get:function(){return this._backgroundMusic2Volume},set:function(t){this._backgroundMusic2Volume=t,this.backgroundMusic2&&this.backgroundMusic2.setVolume(t);}},{key:"soundEffectsVolume",get:function(){return this._soundEffectsVolume},set:function(t){this._soundEffectsVolume=t;for(var e=this.soundEffects,i=0,n=e.length;i<n;i++)e[i].setVolume(t);}}]),t}();Object.assign(it.prototype,tt);var nt=Phaser.Utils.Objects.GetValue,st=function(t){s(r,t);var i=u(r);function r(){return e(this,r),i.apply(this,arguments)}return n(r,[{key:"startTicking",value:function(){c(a(r.prototype),"startTicking",this).call(this),this.scene.sys.events.on("update",this.update,this);}},{key:"stopTicking",value:function(){c(a(r.prototype),"stopTicking",this).call(this),this.scene&&this.scene.sys.events.off("update",this.update,this);}},{key:"update",value:function(t,e){return this.isRunning&&0!==this.timeScale?(this.tick(e),this):this}}]),r}(function(t){s(r,t);var i=u(r);function r(t,n){var s;return e(this,r),(s=i.call(this,t,n)).resetFromJSON(n),s.boot(),s}return n(r,[{key:"resetFromJSON",value:function(t){return this.isRunning=nt(t,"isRunning",!1),this.timeScale=nt(t,"timeScale",1),this.now=nt(t,"now",0),this}},{key:"toJSON",value:function(){return {isRunning:this.isRunning,timeScale:this.timeScale,now:this.now,tickingMode:this.tickingMode}}},{key:"start",value:function(t){return void 0===t&&(t=0),this.delta=0,this.now=t,c(a(r.prototype),"start",this).call(this),this}},{key:"seek",value:function(t){return this.now=t,this}},{key:"setTimeScale",value:function(t){return this.timeScale=t,this}},{key:"tick",value:function(t){return t*=this.timeScale,this.now+=t,this.delta=t,this.emit("update",this.now,this.delta),this}}]),r}(E)),at=Phaser.Math.Clamp,rt=function(){function t(i,n){e(this,t),this.setTimeline(i).reset(n);}return n(t,[{key:"setTimeline",value:function(t){return this.timeline=t,this}},{key:"setName",value:function(t){return this.name=t,this}},{key:"setCallbacks",value:function(t,e,i,n){return this.target=t,this.onStart=e,this.onProgress=i,this.onComplete=n,this}},{key:"setDuration",value:function(t,e){return void 0===e&&(e=!1),this.duration=t,this.remainder=t,this.t=0,this.yoyo=e,this}},{key:"setPaused",value:function(t){return this.isPaused=t,this}},{key:"pause",value:function(){return this.isPaused=!0,this}},{key:"resume",value:function(){return this.isPaused=!1,this}},{key:"setRemoved",value:function(t){return this.removed=t,this}},{key:"remove",value:function(){return this.removed=!0,this}},{key:"seek",value:function(t){return this.remainder=this.duration*(1-t),this}},{key:"reset",value:function(t){return this.setName(t.name).setDuration(t.duration,t.yoyo).setCallbacks(t.target,t.onStart,t.onProgress,t.onComplete).setPaused(!1).setRemoved(!1),this}},{key:"onFree",value:function(){this.setTimeline().setCallbacks();}},{key:"getProgress",value:function(){var t,e,i=1-this.remainder/this.duration;return i=at(i,0,1),this.yoyo&&(void 0===e&&(e=.5),(t=i)<=e?t/=e:t=1-(t-e)/(1-e),i=t),i}},{key:"setProgress",value:function(t){t=at(t,0,1),this.remainder=this.duration*(1-t);}},{key:"runCallback",value:function(t){t&&t(this.target,this.t,this);}},{key:"update",value:function(t,e){if(this.removed)return !0;if(this.isPaused)return !1;this.remainder-=e,this.t=this.getProgress(),this.runCallback(this.onProgress);var i=this.remainder<=0;return i&&this.runCallback(this.onComplete),i}}]),t}(),ot=function(t){s(a,t);var i=u(a);function a(){return e(this,a),i.apply(this,arguments)}return n(a,[{key:"allocate",value:function(){return this.pop()}},{key:"free",value:function(t){t.onFree(),this.push(t);}},{key:"freeMultiple",value:function(t){for(var e=0,i=t.length;e<i;e++)this.free(t[e]);return this}}]),a}(function(){function t(){e(this,t),this.items=[];}return n(t,[{key:"destroy",value:function(){this.clear(),this.items=void 0;}},{key:"pop",value:function(){return this.items.length>0?this.items.pop():null}},{key:"push",value:function(t){return this.items.push(t),this}},{key:"pushMultiple",value:function(t){return this.items.push.apply(this.items,t),t.length=0,this}},{key:"clear",value:function(){return this.items.length=0,this}}]),t}()),ut=Phaser.Utils.Objects.GetValue,ct=new ot,ht=function(t){s(r,t);var i=u(r);function r(t,n){var s;return e(this,r),(s=i.call(this,t,n)).addedTimers=[],s.timers=[],s.timerPool=ut(n,"pool",ct),s}return n(r,[{key:"shutdown",value:function(){this.isShutdown||(this.timerPool.freeMultiple(this.addedTimers).freeMultiple(this.timers),this.timerPool=void 0,this.addedTimers=void 0,this.timers=void 0,c(a(r.prototype),"shutdown",this).call(this));}},{key:"addTimer",value:function(t){var e=this.timerPool.allocate();return e?e.setTimeline(this).reset(t):e=new rt(this,t),this.addedTimers.push(e),e.runCallback(e.onStart),this.isRunning||this.start(),e}},{key:"delayCall",value:function(t,e,i,n){return this.addTimer({duration:t,onComplete:function(t,s,a){void 0===i&&(i=[]),i.push(a),e.apply(n,i);}})}},{key:"delayEvent",value:function(t,e){this.removeDelayEvent(e);var i=this.delayCall(t,(function(){this.removeDelayEvent(e),this.emit(e);}),[],this);return this.once("_remove.".concat(e),(function(){i.remove(),i=void 0;})),this}},{key:"removeDelayEvent",value:function(t){return this.emit("_remove.".concat(t)),this}},{key:"getTimers",value:function(t){for(var e=[],i=[this.addedTimers,this.timers],n=0,s=i.length;n<s;n++)for(var a=i[n],r=0,o=a.length;r<o;r++){var u=a[r];u.name===t&&e.push(u);}return e}},{key:"update",value:function(t,e){var i;if(c(a(r.prototype),"update",this).call(this,t,e),this.isRunning){(i=this.timers).push.apply(i,h(this.addedTimers)),this.addedTimers.length=0;for(var n=[],s=0,o=this.timers.length;s<o;s++){var u=this.timers[s];u.update(this.now,this.delta)?this.timerPool.free(u):n.push(u);}this.timers=n,0===this.timers.length&&0===this.addedTimers.length&&this.complete();}}}]),r}(st),lt="_remove.wait",ft={waitTime:function(t){var e=this.parent.timeline;return e.delayEvent(t,"delay"),this.parent.once(lt,(function(){e.removeDelayEvent("delay");})),this.waitEvent(e,"delay")}},dt={setClickTarget:function(t){this.clickTarget=t,t?d(t)?this.clickEE=t.input:this.clickEE=t.setInteractive():this.clickEE=null;},waitClick:function(){return this.clickEE?this.waitEvent(this.clickEE,"pointerdown"):this.waitTime(0)},waitKeyDown:function(t){var e=this.scene.input.keyboard;return "string"==typeof t?this.waitEvent(e,"keydown-".concat(t.toUpperCase())):this.waitEvent(e,"keydown")}},pt={waitGameObjectTweenComplete:function(t,e,i){var n=this.parent.getGameObjectTweenTask(t,e,i);return n?this.waitEvent(n,"complete"):this.waitTime(0)},waitGameObjectDataFlag:function(t,e,i,n){var s=this.parent.getGameObject(t,e);if(!s)return this.waitTime(0);if(s.getData(i)===n)return this.waitTime(0);var a="changedata-".concat(i),r=function(t,e,i){(e=!!e)===n&&t.emit("_dataFlagMatch");};return s.on(a,r),this.parent.once(lt,(function(){s.off(a,r);})),this.waitEvent(s,"_dataFlagMatch")},waitGameObjectDestroy:function(t,e){var i=this.parent.getGameObject(t,e);return i?this.waitEvent(i,"destroy"):this.waitTime(0)},waitGameObjectManagerEmpty:function(t){if(t){var e=this.parent.getGameObjectManager(t);return e?this.waitEvent(e,"empty"):this.waitTime(0)}var i=this.parent.gameObjectManagers,n=!1;for(var s in i)n=!0,this.waitEvent(i[s],"empty");return n?this.parent:this.waitTime(0)}},gt=function(t,e,i){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1!==e.indexOf(".")){for(var n=e.split("."),s=t,a=i,r=0;r<n.length;r++){if(!s.hasOwnProperty(n[r])){a=i;break}a=s[n[r]],s=s[n[r]];}return a}return i}return i},mt=function(){function t(i,n){e(this,t),this.parent=i,this.waitCompleteEventName=gt(n,"completeEventName","_wait.complete"),this.setClickTarget(gt(n,"clickTarget",this.scene)),this.setTargetCamera(gt(n,"camera",this.scene.cameras.main)),this.waitId=0;}return n(t,[{key:"destroy",value:function(){this.removeWaitEvents(),this.clearWaitCompleteCallbacks(),this.setClickTarget(),this.setTargetCamera();}},{key:"scene",get:function(){return this.parent.managersScene}},{key:"waitEvent",value:function(t,e,i){var n=this.getWaitCompleteTriggerCallback(i);return t.once(e,n,this),this.parent.once(lt,(function(){t.off(e,n,this);})),this.parent}},{key:"getWaitCompleteTriggerCallback",value:function(t){void 0===t&&(t=!0);var e=this.waitId,i=this,n=function(){e<i.waitId||(i.waitId++,i.removeWaitEvents(),i.parent.emit(i.waitCompleteEventName));};if(t){return function(){var t,e,s,a,r,o;t=i.parent,e=0,s=n,(o=g(t)).time.delayedCall(e,(function(){o.sys.events.once("preupdate",(function(){s.call(a,r);}));}));}}return n}},{key:"removeWaitEvents",value:function(){return this.parent.emit(lt),this}},{key:"addWaitCompleteCallback",value:function(t,e){return this.parent.on(this.waitCompleteEventName,t,e),this}},{key:"clearWaitCompleteCallbacks",value:function(){return this.parent.off(this.waitCompleteEventName),this}}]),t}(),vt={waitAny:function(t){if(!t)return this.waitTime(0);var e=!1;for(var i in t)switch(i){case"time":e=!0,this.waitTime(t.time);break;case"click":e=!0,this.waitClick(t.key);break;case"key":e=!0,this.waitKeyDown(t.key);break;case"camera":e=!0,this.waitCameraEffectComplete(t.camera);break;case"bgm":e=!0,this.waitBackgroundMusicComplete();break;case"bgm2":e=!0,this.waitBackgroundMusic2Complete();break;case"se":e=!0,this.waitSoundEffectComplete();break;case"se2":e=!0,this.waitSoundEffect2Complete();break;default:var n=i.split(".");if(2===n.length){var s=n[0],a=n[1],r=this.parent.getGameObjectManager(void 0,s);if(!r)continue;if("number"==typeof r.getProperty(s,a)){e=!0,this.waitGameObjectTweenComplete(void 0,s,a);continue}var o=a,u=o.startsWith("!");u&&(o=o.substring(1)),r.hasData(s,a)&&(e=!0,this.waitGameObjectDataFlag(void 0,s,o,!u));}}return e||this.waitTime(0),this.parent}};Object.assign(mt.prototype,ft,dt,pt,{setTargetCamera:function(t){return this.targetCamera=t,this},waitCameraEffectComplete:function(t){var e,i,n=this.targetCamera;if(!n)return this.waitTime(0);switch(t){case"camera.fadein":e=n.fadeEffect,i="camerafadeincomplete";break;case"camera.fadeout":e=n.fadeEffect,i="camerafadeoutcomplete";break;case"camera.flash":e=n.flashEffect,i="cameraflashcomplete";break;case"camera.shake":e=n.shakeEffect,i="camerashakecomplete";break;case"camera.zoom":e=n.zoomEffect,i="camerazoomcomplete";break;case"camera.rotate":e=n.rotateToEffect,i="camerarotatecomplete";break;case"camera.scroll":e=n.panEffect,i="camerapancomplete";}return e.isRunning?this.waitEvent(n,i):this.waitTime(0)}},{waitSoundEffectComplete:function(){if(!this.parent.soundManager)return this.waitTime(0);var t=this.parent.soundManager.getLastSoundEffect();return t?this.waitEvent(t,"complete"):this.waitTime(0)},waitSoundEffect2Complete:function(){if(!this.parent.soundManager)return this.waitTime(0);var t=this.parent.soundManager.getLastSoundEffect2();return t?this.waitEvent(t,"complete"):this.waitTime(0)},waitBackgroundMusicComplete:function(){if(!this.parent.soundManager)return this.waitTime(0);var t=this.parent.soundManager.getBackgroundMusic();return t?this.waitEvent(t,"complete"):this.waitTime(0)},waitBackgroundMusic2Complete:function(){if(!this.parent.soundManager)return this.waitTime(0);var t=this.parent.soundManager.getBackgroundMusic2();return t?this.waitEvent(t,"complete"):this.waitTime(0)}},vt);var yt=Phaser.Utils.Objects.GetValue,kt=function(t,e){this.managersScene=t;var i=yt(e,"sounds");return !1!==i&&(this.soundManager=new it(t,i)),this.gameObjectManagers={},this.timeline=new ht(this),this.waitEventManager=new mt(this,e),this},bt=function(t){for(var e in this.timeline.timeScale=t,this.gameObjectManagers)this.gameObjectManagers[e].setTimeScale(t);return this},Et=function(){return this.timeline.timeScale},Mt=function(t){for(var e in this.waitEventManager.destroy(),this.waitEventManager=void 0,this.soundManager&&this.soundManager.destroy(),this.soundManager=void 0,this.gameObjectManagers)this.gameObjectManagers[e].destroy(t),delete this.gameObjectManagers[e];this.timeline&&this.timeline.destroy(),this.timeline=void 0,this.managersScene=void 0;},wt={hasProperty:function(t){var e=this.gameObject;return !!e.hasOwnProperty(t)||void 0!==e[t]},getProperty:function(t){return this.gameObject[t]},setProperty:function(t,e){return this.gameObject[t]=e,this},easeProperty:function(t,e,i,n,s,a,r){var o=this.tweens,u=o[t];u&&u.remove();var c=this.gameObject,h={targets:c,duration:i,ease:n,repeat:s,yoyo:a,onComplete:function(){o[t].remove(),o[t]=null,r&&r(c,t);},onCompleteScope:this};return h[t]=e,(u=this.scene.tweens.add(h)).timeScale=this.timeScale,o[t]=u,this}},Tt={hasMethod:function(t){return "function"==typeof this.gameObject[t]},call:function(t){if(!this.hasMethod(t))return this;for(var e=this.gameObject,i=arguments.length,n=new Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];return e[t].apply(e,n),this}},Ot=function(){function t(i,n,s){e(this,t),this.GOManager=i,this.tweens={},this.setGO(n,s);}return n(t,[{key:"scene",get:function(){return this.GOManager.scene}},{key:"timeScale",get:function(){return this.GOManager.timeScale}},{key:"destroy",value:function(){this.freeGO(),this.GOManager=void 0;}},{key:"freeTweens",value:function(){var t,e=this.tweens;for(var i in e)(t=e[i])&&t.remove(),e[i]=null;return this}},{key:"freeGO",value:function(){return this.freeTweens(),this.gameObject.destroy(),this.gameObject=void 0,this}},{key:"setGO",value:function(t,e){return t.setName(e),this.gameObject=t,this.name=e,this.freeTweens(),this}},{key:"setTimeScale",value:function(t){var e=this.tweens;for(var i in e){var n=e[i];n&&(n.timeScale=t);}return this}}]),t}();Object.assign(Ot.prototype,wt,Tt,{hasData:function(t){var e=this.gameObject;return !!e.data&&e.data.has(t)},getData:function(t){return this.gameObject.getData(t)},setData:function(t,e){return this.gameObject.setData(t,e),this}});var St={tint:0,alpha:1},jt={setGOFadeMode:function(t){return "string"==typeof t&&(t=St[t]),this.fadeMode=t,this},setGOFadeTime:function(t){return this.fadeTime=t,this},hasTintFadeEffect:function(t){return (void 0===this.fadeMode||0===this.fadeMode)&&this.fadeTime>0&&void 0!==t.setTint},hasAlphaFadeEffect:function(t){return (void 0===this.fadeMode||1===this.fadeMode)&&this.fadeTime>0&&void 0!==t.setAlpha},fadeBob:function(t,e,i,n){var s=t.gameObject;return this.hasTintFadeEffect(s)?(void 0!==e&&t.setProperty("tintGray",255*e),t.easeProperty("tintGray",Math.floor(255*i),this.fadeTime,"Linear",0,!1,n)):this.hasAlphaFadeEffect(s)?(void 0!==e&&t.setProperty("alpha",e),t.easeProperty("alpha",i,this.fadeTime,"Linear",0,!1,n)):n&&n(s),this}},Ct=function(t){return t>>16&255},Pt=function(t){return t>>8&255},xt=function(t){return 255&t},Gt=Phaser.Events.EventEmitter,Bt=function(t,e,i,n,s,a){return void 0===a?a={}:!0===a&&(a=Rt),"number"!=typeof i&&(i=0,n=0),a.x=s.x+s.width*t+i,a.y=s.y+s.height*e+n,a},Rt={},Dt=function(t,e,i,n,s,a,r){if(t.hasOwnProperty("vp"))return t;"function"==typeof i&&(r=i,i=void 0),"function"==typeof s&&(r=s,s=void 0),void 0===i&&(i=.5),void 0===n&&(n=.5),void 0===s&&(s=0),void 0===a&&(a=0),void 0===r&&(r=Bt),function(t){if(t.events)return t;var e=new Gt,i=t.x;Object.defineProperty(t,"x",{get:function(){return i},set:function(n){i!==n&&(i=n,e.emit("update",t));}});var n=t.y;Object.defineProperty(t,"y",{get:function(){return n},set:function(i){n!==i&&(n=i,e.emit("update",t));}});var s=t.width;Object.defineProperty(t,"width",{get:function(){return s},set:function(i){s!==i&&(s=i,e.emit("update",t));}});var a=t.height;Object.defineProperty(t,"height",{get:function(){return a},set:function(i){a!==i&&(a=i,e.emit("update",t));}}),t.events=e;}(e);var o=e.events;t.vp=e;var u=function(){r(i,n,s,a,e,t);};o.on("update",u),t.once("destroy",(function(){o.off("update",u),t.vp=void 0;})),Object.defineProperty(t,"vpx",{get:function(){return i},set:function(t){i!==t&&(i=t,u());}}),Object.defineProperty(t,"vpy",{get:function(){return n},set:function(t){n!==t&&(n=t,u());}}),Object.defineProperty(t,"vpxOffset",{get:function(){return s},set:function(t){s!==t&&(s=t,u());}}),Object.defineProperty(t,"vpyOffset",{get:function(){return a},set:function(t){a!==t&&(a=t,u());}}),u();},Ft=Phaser.Utils.Array.Remove,_t={has:function(t){return this.bobs.hasOwnProperty(t)},exists:function(t){return this.bobs.hasOwnProperty(t)},get:function(t){return this.bobs[t]},getGO:function(t){var e=this.get(t);return e?e.gameObject:null},addGO:function(t,e){this.remove(t,!0),this.hasTintFadeEffect(e)&&function(t,e){if(t.hasOwnProperty("tintR"))return t;void 0===e&&(e=16777215);var i=Ct(e),n=Pt(e),s=xt(e);Object.defineProperty(t,"tint",{get:function(){return e},set:function(a){a=16777215&Math.floor(a),t.setTint&&t.setTint(a),e!==a&&(i=Ct(e=a),n=Pt(e),s=xt(e));}}),Object.defineProperty(t,"tintR",{get:function(){return i},set:function(n){n=255&Math.floor(n),i!==n&&(i=n,t.tint=(255&n)<<16|65535&e);}}),Object.defineProperty(t,"tintG",{get:function(){return n},set:function(i){i=255&Math.floor(i),n!==i&&(n=i,t.tint=(255&i)<<8|16711935&e);}}),Object.defineProperty(t,"tintB",{get:function(){return s},set:function(i){i=255&Math.floor(i),s!==i&&(s=i,t.tint=255&i|16776960&e);}}),Object.defineProperty(t,"tintGray",{get:function(){return Math.floor((i+n+s)/3)},set:function(e){e=255&Math.floor(e),i===e&&n===e&&s===e||(i=e,n=e,s=e,t.tint=(255&e)<<16|(255&e)<<8|255&e);}}),t.tint=e;}(e),this.viewportCoordinateEnable&&Dt(e,this.viewport),e.once("destroy",(function(){Ft(this.removedGOs,e),this.isEmpty&&this.emit("empty");}),this);var i=new this.BobClass(this,e,t);return this.bobs[t]=i,this},add:function(t){for(var e=this.createGameObjectCallback,i=this.createGameObjectScope,n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];var r=e.call.apply(e,[i,this.scene].concat(s));this.addGO(t,r);var o=this.get(t);return this.fadeBob(o,0,1),this},forEachGO:function(t,e){for(var i in this.bobs){var n=this.bobs[i].gameObject;if(e?t.call(e,n,i,this):t(n,i,this))break}return this}},Vt={remove:function(t,e){if(!this.has(t))return this;var i=this.get(t);return delete this.bobs[t],this.removedGOs.push(i.gameObject),e?i.destroy():this.fadeBob(i,void 0,0,(function(){i.destroy();})),this},removeAll:function(){var t=this.bobs;for(var e in t)this.remove(e);return this},clear:function(t){void 0===t&&(t=!0);var e=this.bobs;for(var i in e)t&&e[i].destroy(),delete e[i];return this.removedGOs.length=0,this}},Lt={hasProperty:function(t,e){return !!this.has(t)&&this.get(t).hasProperty(e)},getProperty:function(t,e){if(this.has(t))return this.get(t).getProperty(e)},isNumberProperty:function(t,e){return "number"==typeof this.getProperty(t,e)},setProperty:function(t,e,i){return this.has(t)?(this.symbols&&"string"==typeof i&&this.isNumberProperty(t,e)&&(i in this.symbols?i=this.symbols[i]:console.warn("Can't find symbol ".concat(i))),this.get(t).setProperty(e,i),this):this},easeProperty:function(t,e,i,n,s,a,r,o){return this.has(t)?(void 0===n&&(n=1e3),void 0===s&&(s="Linear"),void 0===a&&(a=0),void 0===r&&(r=!1),this.symbols&&"string"==typeof i&&this.isNumberProperty(t,e)&&(i in this.symbols?i=this.symbols[i]:console.warn("Can't find symbol ".concat(i))),this.get(t).easeProperty(e,i,n,s,a,r,o),this):this},hasTweenTask:function(t,e){return !!this.has(t)&&this.get(t).tweens.hasOwnProperty(e)},getTweenTask:function(t,e){if(!this.has(t))return null;var i=this.get(t).tweens[e];return i||null}},It={hasMethod:function(t,e){return !!this.has(t)&&this.get(t).hasMethod(e)},call:function(t,e){var i;if(!this.has(t))return this;for(var n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a];return (i=this.get(t)).call.apply(i,[e].concat(s)),this}},At={hasData:function(t,e){return !!this.has(t)&&this.get(t).hasData(e)},getData:function(t,e){if(this.has(t))return this.get(t).getData(e)},setData:function(t,e,i){return this.has(t)?(this.get(t).setData(e,i),this):this}},Wt=function(t){return void 0!==t.displayWidth?t.displayWidth:t.width},Nt=function(t){return void 0!==t.displayHeight?t.displayHeight:t.height};Phaser.Geom.Rectangle;var Ut=Phaser.Math.Vector2,Jt=Phaser.Math.RotateAround,zt=void 0,Xt=function(t,e,i){(void 0===i&&(i=!1),0!==t.rotation&&Jt(e,t.x,t.y,t.rotation),i&&t.parentContainer)&&t.parentContainer.getBoundsTransformMatrix().transformPoint(e.x,e.y,e);return e},Yt=Phaser.Utils.Objects.GetValue,Kt=function(t,e,i,n,s,a,r){if(t.getBounds||void 0!==t.width&&void 0!==t.height){void 0===i&&(i=16777215),void 0===n&&(n=1),void 0===s&&(s=null),void 0===a&&(a=1),void 0===r&&(r=0);var o=function(t,e,i){return void 0===e?e=new Ut:!0===e&&(void 0===zt&&(zt=new Ut),e=zt),t.getTopLeft?t.getTopLeft(e):(e.x=t.x-Wt(t)*t.originX,e.y=t.y-Nt(t)*t.originY,Xt(t,e,i))}(t,$t[0]);o.x-=r,o.y-=r;var u=function(t,e,i){return void 0===e?e=new Ut:!0===e&&(void 0===zt&&(zt=new Ut),e=zt),t.getTopRight?t.getTopRight(e):(e.x=t.x-Wt(t)*t.originX+Wt(t),e.y=t.y-Nt(t)*t.originY,Xt(t,e,i))}(t,$t[1]);u.x+=r,u.y-=r;var c=function(t,e,i){return void 0===e?e=new Ut:!0===e&&(void 0===zt&&(zt=new Ut),e=zt),t.getBottomRight?t.getBottomRight(e):(e.x=t.x-Wt(t)*t.originX+Wt(t),e.y=t.y-Nt(t)*t.originY+Nt(t),Xt(t,e,i))}(t,$t[2]);c.x+=r,c.y+=r;var h=function(t,e,i){return void 0===e?e=new Ut:!0===e&&(void 0===zt&&(zt=new Ut),e=zt),t.getBottomLeft?t.getBottomLeft(e):(e.x=t.x-Wt(t)*t.originX,e.y=t.y-Nt(t)*t.originY+Nt(t),Xt(t,e,i))}(t,$t[3]);h.x-=r,h.y+=r,null!==s&&e.fillStyle(s,a).fillPoints($t,!0,!0),null!==i&&e.lineStyle(n,i).strokePoints($t,!0,!0);}},$t=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],Ht={drawGameObjectsBounds:function(t,e){return this.forEachGO((function(i){i.drawBounds?i.drawBounds(t,e):function(t,e,i){var n,s,a,r,o;if("number"==typeof i?n=i:(n=Yt(i,"color"),s=Yt(i,"lineWidth"),a=Yt(i,"fillColor"),r=Yt(i,"fillAlpha",1),o=Yt(i,"padding",0)),Array.isArray(t))for(var u=0,c=t.length;u<c;u++)Kt(t[u],e,n,s,a,r,o);else Kt(t,e,n,s,a,r,o);}(i,t,e);})),this}};Object.assign(Ht,jt,_t,Vt,Lt,It,At);var qt=Phaser.Cameras.Scene2D.BaseCamera,Zt=Phaser.Geom.Rectangle,Qt=function(t,e,i){return e instanceof qt||(i=e,e=void 0),void 0===i?i=new Zt:!0===i&&(i=te),e?t.scale.getViewPort(e,i):t.scale.getViewPort(i)},te=new Zt,ee=Phaser.Utils.Objects.GetValue,ie=function(){function t(i,n){e(this,t),this.scene=i,this.BobClass=ee(n,"BobClass",Ot),this.setCreateGameObjectCallback(ee(n,"createGameObject"),ee(n,"createGameObjectScope")),this.setEventEmitter(ee(n,"eventEmitter",void 0));var s=ee(n,"fade",500);"number"==typeof s?(this.setGOFadeMode(),this.setGOFadeTime(s)):(this.setGOFadeMode(ee(s,"mode")),this.setGOFadeTime(ee(s,"time",500)));var a=ee(n,"viewportCoordinate",!1);!1!==a?(this.setViewportCoordinateEnable(ee(n,"enable",!0)),this.setViewport(ee(a,"viewport"))):this.setViewportCoordinateEnable(!1),this.setSymbols(ee(n,"symbols")),this.bobs={},this.removedGOs=[],this._timeScale=1;}return n(t,[{key:"destroy",value:function(t){this.clear(!t),this.createGameObjectCallback=void 0,this.viewport=void 0,this.scene=void 0;}},{key:"timeScale",get:function(){return this._timeScale},set:function(t){if(this._timeScale!==t){this._timeScale=t;var e=this.bobs;for(var i in e)e[i].setTimeScale(t);}}},{key:"setTimeScale",value:function(t){return this.timeScale=t,this}},{key:"setCreateGameObjectCallback",value:function(t,e){return this.createGameObjectCallback=t,this.createGameObjectScope=e,this}},{key:"setViewportCoordinateEnable",value:function(t){return void 0===t&&(t=!0),this.viewportCoordinateEnable=t,this}},{key:"setViewport",value:function(t){return void 0===t&&(t=Qt(this.scene,this.scene.cameras.main)),this.viewport=t,this}},{key:"setSymbols",value:function(t){return this.symbols=t,this}},{key:"isEmpty",get:function(){return function(t){for(var e in t)return !1;return !0}(this.bobs)&&0===this.removedGOs.length}}]),t}();Object.assign(ie.prototype,p,Ht);var ne={addGameObjectManager:function(t,e){void 0===t&&(t={}),void 0===e&&(e=ie),t.createGameObjectScope||(t.createGameObjectScope=this);var i=new e(this.managersScene,t);return this.gameObjectManagers[t.name]=i,this},getGameObjectManager:function(t,e){if(t)return i=this.gameObjectManagers[t];for(var t in this.gameObjectManagers){var i;if((i=this.gameObjectManagers[t]).has(e))return i}},getGameObjectManagerNames:function(){var t=[];for(var e in this.gameObjectManagers)t.push(e);return t},getGameObjectManagerName:function(t){for(var e in this.gameObjectManagers)if(this.gameObjectManagers[e].has(t))return e},hasGameObjectMananger:function(t){return t in this.gameObjectManagers}},se={createGameObject:function(t,e){for(var i,n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a];return (i=this.getGameObjectManager(t,e)).add.apply(i,[e].concat(s)),this},destroyGameObject:function(t,e){var i=this.getGameObjectManager(t,e);return void 0===e?i.removeAll():i.remove(e),this},callGameObjectMethod:function(t,e,i){for(var n,s=arguments.length,a=new Array(s>3?s-3:0),r=3;r<s;r++)a[r-3]=arguments[r];return (n=this.getGameObjectManager(t,e)).call.apply(n,[e,i].concat(a)),this},setGameObjectProperty:function(t,e,i,n){return this.getGameObjectManager(t,e).setProperty(e,i,n),this},easeGameObjectProperty:function(t,e,i,n,s,a,r,o){return this.getGameObjectManager(t,e).easeProperty(e,i,n,s,a,r,o),this},getGameObjectTweenTask:function(t,e,i){return this.getGameObjectManager(t,e).getTweenTask(e,i)},getGameObject:function(t,e,i){var n=this.getGameObjectManager(t,e);if("string"==typeof e)return n.getGO(e);var s=e;for(e in void 0===s&&(s=n.bobs),void 0===i&&(i={}),s)i[e]=n.getGO(e);return i},addGameObject:function(t,e,i){var n=this.getGameObjectManager(t,e);if("string"==typeof e)n.addGO(e,i);else {var s=e;for(e in s)n.addGO(e,s[e]);}return this},drawGameObjectsBounds:function(t,e,i){t instanceof Phaser.GameObjects.Graphics&&(i=e,e=t,t=void 0),void 0===t&&(t=this.getGameObjectManagerNames()),Array.isArray(t)||(t=[t]);for(var n=0,s=t.length;n<s;n++)this.getGameObjectManager(t[n]).drawGameObjectsBounds(e,i);return this}},ae=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,re=/^0x[0-9A-F]+$/i,oe=function(t){return "string"!=typeof t||(""===t?t=null:ae.test(t)?t=parseFloat(t):re.test(t)?t=parseInt(t,16):"false"===t?t=!1:"true"===t&&(t=!0)),t},ue=function(t){return t.replace(ce,"\\$&").replace(he,"\\x2d")},ce=/[|\\{}()[\]^$+*?.]/g,he=/-/g,le=function(){function t(i){e(this,t),this.setEventEmitter(gt(i,"eventEmitter",void 0)),this.setValueConverter(gt(i,"valueConvert",!0)),this.setLoopEnable(gt(i,"loop",!1)),this.setMultipleLinesTagEnable(gt(i,"multipleLinesTag",!1));var n=gt(i,"delimiters","<>");this.setDelimiters(n[0],n[1]),this.setTranslateTagNameCallback(gt(i,"translateTagNameCallback")),this.isRunning=!1,this.isPaused=!1,this.skipEventFlag=!1,this.justCompleted=!1,this.lastTagStart=null,this.lastTagEnd=null,this.lastContent=null;}return n(t,[{key:"shutdown",value:function(){this.destroyEventEmitter();}},{key:"destroy",value:function(){this.shutdown();}},{key:"setMultipleLinesTagEnable",value:function(t){return void 0===t&&(t=!0),this.multipleLinesTagEnable=t,this}},{key:"setDelimiters",value:function(t,e){void 0===e&&(e=t[1],t=t[0]),this.delimiterLeft=t,this.delimiterRight=e,t=ue(this.delimiterLeft),e=ue(this.delimiterRight);var i=this.multipleLinesTagEnable?"gs":"gi";return this.reSplit=RegExp("".concat(t,"(.+?)").concat(e),i),this}},{key:"setTranslateTagNameCallback",value:function(t){return this.translateTagNameCallback=t,this}},{key:"setValueConverter",value:function(t){return !0===t?t=oe:t||(t=fe),this.valueConverter=t,this}},{key:"setLoopEnable",value:function(t){return void 0===t&&(t=!0),this.loopEnable=t,this}},{key:"setSource",value:function(t){return this.source=t,this}},{key:"resetIndex",value:function(t){return void 0===t&&(t=0),this.progressIndex=t,this.reSplit.lastIndex=t,this.lastTagStart=null,this.lastTagEnd=null,this.lastContent=null,this.justCompleted=!1,this.isRunning=!1,this}},{key:"start",value:function(t){return this.setSource(t).restart(),this}},{key:"restart",value:function(){this.resetIndex().next();}},{key:"next",value:function(){if(this.isPaused&&this.onResume(),this.isRunning)return this;if(this.isRunning=!0,this.justCompleted)return this.isRunning=!1,this;0===this.reSplit.lastIndex&&this.onStart();var t=this.source,e=t.length;for(this.reSplit.lastIndex=this.progressIndex;;){var i=this.reSplit.exec(t);if(!i){if(this.progressIndex<e&&(this.onContent(t.substring(this.progressIndex,e)),this.isPaused)){this.progressIndex=e;break}return this.onComplete(),void(this.isRunning=!1)}var n=this.reSplit.lastIndex,s=n-i[0].length;if(this.progressIndex<s&&(this.onContent(t.substring(this.progressIndex,s)),this.isPaused)){this.progressIndex=s;break}if(this.onTag(i[1]),this.progressIndex=n,this.isPaused)break}return this.isRunning=!1,this}},{key:"skipEvent",value:function(){return this.skipEventFlag=!0,this}},{key:"pause",value:function(){return this.isPaused||this.onPause(),this}},{key:"pauseUntilEvent",value:function(t,e){return this.isPaused||(this.pause(),t.once(e,(function(){this.next();}),this)),this}},{key:"onContent",value:function(t){this.skipEventFlag=!1,this.emit("content",t),this.lastContent=t;}},{key:"onTag",value:function(t){}},{key:"onStart",value:function(){this.isRunning=!0,this.emit("start",this);}},{key:"onComplete",value:function(){this.isRunning=!1,this.justCompleted=!0,this.emit("complete",this),this.loopEnable&&this.resetIndex();}},{key:"onPause",value:function(){this.isPaused=!0,this.emit("pause",this);}},{key:"onResume",value:function(){this.isPaused=!1,this.emit("resume",this);}}]),t}(),fe=function(t){return t};Object.assign(le.prototype,p);var de=function(t){s(r,t);var i=u(r);function r(t){var n;e(this,r),void 0===t&&(t={}),t.hasOwnProperty("multipleLinesTag")||(t.multipleLinesTag=!1),(n=i.call(this,t)).setTagExpression(gt(t,"regex.tag",void 0)),n.setValueExpression(gt(t,"regex.value",void 0));var s=gt(t,"delimiters","<>");return n.setDelimiters(s[0],s[1]),n}return n(r,[{key:"setTagExpression",value:function(t){return t||(t=pe),this.tagExpression=t,this}},{key:"setValueExpression",value:function(t){return t||(t=pe),this.valueExpression=t,this}},{key:"setDelimiters",value:function(t,e){c(a(r.prototype),"setDelimiters",this).call(this,t,e);var i="(".concat(this.tagExpression,")(=(").concat(this.valueExpression,"))?");if(this.reTag=RegExp(i,"i"),this.tagExpression!==pe||this.valueExpression!==pe){var n="".concat(this.tagExpression,"(=").concat(this.valueExpression,")?"),s="/".concat(this.tagExpression);t=ue(this.delimiterLeft),e=ue(this.delimiterRight);var o=this.multipleLinesTagEnable?"gs":"gi";this.reSplit=RegExp("".concat(t,"((").concat(n,")|(").concat(s,"))").concat(e),o);}return this}},{key:"onTag",value:function(t){var e=t.match(this.reTag),i=e[1],n="/"===i.charAt(0);if(n&&(i=i.substring(1,i.length)),this.translateTagNameCallback&&(i=this.translateTagNameCallback(i)),this.skipEventFlag=!1,n)this.emit("-".concat(i)),this.skipEventFlag||this.emit("-",i),this.lastTagEnd=i;else {var s=function(t,e){if(null==t)return [];void 0===e&&(e=oe);for(var i=t.split(","),n=0,s=i.length;n<s;n++)i[n]=e(i[n]);return i}(e[3],this.valueConverter);this.emit.apply(this,["+".concat(i)].concat(h(s))),this.skipEventFlag||this.emit.apply(this,["+",i].concat(h(s))),this.lastTagStart=i;}}}]),r}(le),pe="[^=]+",ge=Phaser.Math.DegToRad,me=[function(t,e,i){var n="wait",s="click";e.on("+".concat(n),(function(i){t.wait(i),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();})).on("+".concat(s),(function(){t.wait("click"),e.skipEvent();})).on("-".concat(s),(function(){e.skipEvent();}));},function(t,e,i){var n="se";e.on("+".concat(n),(function(i,n){this.skipSoundEffect||(t.soundManager.playSoundEffect(i),n&&t.soundManager.fadeInSoundEffect(n),e.skipEvent());})).on("-".concat(n),(function(){e.skipEvent();}));n="se2";e.on("+".concat(n),(function(i,n){this.skipSoundEffect||(t.soundManager.playSoundEffect2(i),n&&t.soundManager.fadeInSoundEffect2(n),e.skipEvent());})).on("-".concat(n),(function(){e.skipEvent();}));},function(t,e,i){var n="se.fadein";e.on("+".concat(n),(function(i){t.soundManager.fadeInSoundEffect(i),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();}));n="se2.fadein";e.on("+".concat(n),(function(i){t.soundManager.fadeInSoundEffect2(i),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();}));},function(t,e,i){var n="se.fadeout";e.on("+".concat(n),(function(i,n){n="stop"===n,t.soundManager.fadeOutSoundEffect(i,n),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();}));n="se2.fadeout";e.on("+".concat(n),(function(i,n){n="stop"===n,t.soundManager.fadeOutSoundEffect2(i,n),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();}));},function(t,e,i){var n="se.volume";e.on("+".concat(n),(function(i){t.soundManager.setSoundEffectVolume(i,!0),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();}));n="se2.volume";e.on("+".concat(n),(function(i){t.soundManager.setSoundEffectVolume2(i,!0),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();}));},function(t,e,i){var n="bgm";e.on("+".concat(n),(function(i,n){t.soundManager.playBackgroundMusic(i),n&&t.soundManager.fadeInBackgroundMusic(n),e.skipEvent();})).on("-".concat(n),(function(){t.soundManager.stopBackgroundMusic(),e.skipEvent();}));n="bgm2";e.on("+".concat(n),(function(i,n){t.soundManager.playBackgroundMusic2(i),n&&t.soundManager.fadeInBackgroundMusic2(n),e.skipEvent();})).on("-".concat(n),(function(){t.soundManager.stopBackgroundMusic2(),e.skipEvent();}));},function(t,e,i){var n="bgm.fadein";e.on("+".concat(n),(function(i){t.soundManager.fadeInBackgroundMusic(i),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();}));n="bgm2.fadein";e.on("+".concat(n),(function(i){t.soundManager.fadeInBackgroundMusic2(i),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();}));},function(t,e,i){var n="bgm.fadeout";e.on("+".concat(n),(function(i,n){n="stop"===n,t.soundManager.fadeOutBackgroundMusic(i,n),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();}));n="bgm2.fadeout";e.on("+".concat(n),(function(i,n){n="stop"===n,t.soundManager.fadeOutBackgroundMusic2(i,n),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();}));},function(t,e,i){var n="bgm.cross";e.on("+".concat(n),(function(i,n){t.soundManager.crossFadeBackgroundMusic(i,n),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();}));n="bgm2.cross";e.on("+".concat(n),(function(i,n){t.soundManager.crossFadeBackgroundMusic2(i,n),e.skipEvent();})).on("-".concat(n),(function(){e.skipEvent();}));},function(t,e,i){var n="bgm.pause";e.on("+".concat(n),(function(){t.soundManager.pauseBackgroundMusic(),e.skipEvent();})).on("-".concat(n),(function(){t.soundManager.resumeBackgroundMusic(),e.skipEvent();}));n="bgm2.pause";e.on("+".concat(n),(function(){t.soundManager.pauseBackgroundMusic2(),e.skipEvent();})).on("-".concat(n),(function(){t.soundManager.resumeBackgroundMusic2(),e.skipEvent();}));},function(t,e,i){e.on("+".concat("camera.fadein"),(function(i,n,s,a){t.targetCamera.fadeIn(i,n,s,a),e.skipEvent();}));},function(t,e,i){e.on("+".concat("camera.fadeout"),(function(i,n,s,a){t.targetCamera.fadeOut(i,n,s,a),e.skipEvent();}));},function(t,e,i){e.on("+".concat("camera.shake"),(function(i,n){t.targetCamera.shake(i,n),e.skipEvent();}));},function(t,e,i){e.on("+".concat("camera.flash"),(function(i,n,s,a){t.targetCamera.flash(i,n,s,a),e.skipEvent();}));},function(t,e,i){var n="camera.zoom";e.on("+".concat(n),(function(i){t.targetCamera.setZoom(i),e.skipEvent();})).on("+".concat(n,".to"),(function(i,n,s){t.targetCamera.zoomTo(i,n,s),e.skipEvent();}));},function(t,e,i){var n="camera.rotate";e.on("+".concat(n),(function(i){t.targetCamera.setRotation(ge(i)),e.skipEvent();})).on("+".concat(n,".to"),(function(i,n,s){i=ge(i),t.targetCamera.rotateTo(ge(i),!1,n,s),e.skipEvent();}));},function(t,e,i){var n="camera.scroll";e.on("+".concat(n),(function(i,n){t.targetCamera.setScroll(i,n),e.skipEvent();})).on("+".concat(n,".to"),(function(i,n,s,a){var r=t.targetCamera,o=r.scrollX,u=r.scrollY;r.setScroll(i,n),i+=r.centerX,n+=r.centerY,r.setScroll(o,u),r.pan(i,n,s,a),e.skipEvent();}));},function(t,e,i){e.on("content",(function(i){if(!e.skipEventFlag&&"\n"!==i){i=i.replaceAll("\\n","\n");var n=t.contentCallback;if(n){var s=t.contentCallbackScope;s?n.call(s,i):n(i),e.skipEvent();}t.emit("+".concat(e.lastTagStart,"#content"),i),t.emit("content",i);}}));},function(t,e,i){e.on("+",(function(i){if(!e.skipEventFlag){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];t.emit.apply(t,["+".concat(i),e].concat(s));}})).on("-",(function(i){e.skipEventFlag||t.emit("-".concat(i),e);}));}],ve=Phaser.Utils.Objects.GetValue,ye=function(t){s(r,t);var i=u(r);function r(t,n){var s;return e(this,r),void 0===n&&(n={}),n.hasOwnProperty("delimiters")||(n.delimiters="[]"),function(t,e,i){for(var n=0,s=me.length;n<s;n++)me[n](t,e,i);e.on("start",(function(){t.emit("start",e);})).on("complete",(function(){t.emit("complete",e);}));}(t,o(s=i.call(this,n)),n),s.setCommentLineStartSymbol(ve(n,"comment","//")),s}return n(r,[{key:"setCommentLineStartSymbol",value:function(t){return this.commentLineStart=t,this}},{key:"start",value:function(t){return c(a(r.prototype),"start",this).call(this,function(t,e){for(var i=t.commentLineStart,n=e.split("\n"),s=0,a=n.length;s<a;s++){var r=n[s];""===r||(0===r.trim().length||i&&r.startsWith(i))&&(n[s]="");}return n.join("")}(this,t)),this}}]),r}(de),ke=function(t){s(r,t);var i=u(r);function r(){return e(this,r),i.apply(this,arguments)}return n(r,[{key:"playAnimation",value:function(t){return this.gameObject.anims.timeScale=this.timeScale,this.gameObject.play(t),this}},{key:"stopAnimation",value:function(){return this.gameObject.stop(),this}},{key:"chainAnimation",value:function(t){return this.gameObject.chain(t),this}},{key:"pauseAnimation",value:function(){return this.gameObject.anims.pause(),this}},{key:"setTimeScale",value:function(t){return c(a(r.prototype),"setTimeScale",this).call(this,t),this.gameObject.anims&&(this.gameObject.anims.timeScale=t),this}}]),r}(Ot),be={};Object.assign(be,{playAnimation:function(t,e){return this.has(t)||this.add(t),this.get(t).playAnimation(e),this},stopAnimation:function(t){return this.has(t)?(this.get(t).stopAnimation(),this):this},chainAnimation:function(t,e){return this.has(t)?(this.get(t).chainAnimation(e),this):this},pauseAnimation:function(t){return this.has(t)?(this.get(t).pauseAnimation(),this):this}});var Ee=function(t){s(r,t);var i=u(r);function r(t,n){return e(this,r),void 0===n&&(n={}),n.BobClass=ke,i.call(this,t,n)}return n(r,[{key:"setCreateGameObjectCallback",value:function(t,e){return t&&"sprite"!==t?"image"===t&&(t=we):t=Me,c(a(r.prototype),"setCreateGameObjectCallback",this).call(this,t,e),this}}]),r}(ie),Me=function(t,e,i){return "string"!=typeof i&&"number"!=typeof i&&(i=void 0),t.add.sprite(0,0,e,i)},we=function(t,e,i){return "string"!=typeof i&&"number"!=typeof i&&(i=void 0),t.add.image(0,0,e,i)};Object.assign(Ee.prototype,be);var Te=function(t,e){return 3===t.length&&t[0]===e&&"play"===t[2]},Oe=[function(t,e,i){var n=i.name,s=t.getGameObjectManager(n);e.on("+",(function(t){if(!e.skipEventFlag){var i,a=t.split(".");if(Te(a,n)){i=a[1];var r=Array.prototype.slice.call(arguments,1),o=r.shift();s.playAnimation(i,o),r.length>0&&s.chainAnimation(i,r),e.skipEvent();}}})).on("+",(function(t){if(!e.skipEventFlag){var i,a=t.split(".");(function(t,e){return 3===t.length&&t[0]===e&&"stop"===t[2]})(a,n)&&(i=a[1],s.stopAnimation(i),e.skipEvent());}})).on("-",(function(t){if(!e.skipEventFlag){var i,a=t.split(".");Te(a,n)&&(i=a[1],s.stopAnimation(i),e.skipEvent());}}));},function(t,e,i){var n=i.name,s=t.getGameObjectManager(n);e.on("+",(function(t){if(!e.skipEventFlag){var i,a=t.split(".");(function(t,e){return 3===t.length&&t[0]===e&&"pause"===t[2]})(a,n)&&(i=a[1],s.pauseAnimation(i),e.skipEvent());}}));},function(t,e,i){var n=i.name,s=t.getGameObjectManager(n);e.on("+",(function(t){if(!e.skipEventFlag){var i,a=t.split(".");if(function(t,e){return 3===t.length&&t[0]===e&&"chain"===t[2]}(a,n)){i=a[1];var r=Array.prototype.slice.call(arguments,1);s.chainAnimation(i,r),e.skipEvent();}}}));}],Se=function(t){void 0===t&&(t={}),t.name="sprite",t.parseCallbacks=Oe,this.addGameObjectManager(t,Ee);},je=Phaser.GameObjects.Text,Ce=Phaser.GameObjects.BitmapText,Pe=function(t){return t instanceof Ce?2:function(t){return t instanceof je}(t)?0:1},xe=Phaser.Utils.Objects.GetFastValue,Ge=Phaser.Utils.Objects.GetValue,Be=function(t){s(r,t);var i=u(r);function r(t,n){var s;return e(this,r),(s=i.call(this,t,n)).timer=null,s.resetFromJSON(n),s}return n(r,[{key:"resetFromJSON",value:function(t){this.setTextWrapEnable(Ge(t,"wrap",!1)),this.setTypeMode(Ge(t,"typeMode",0)),this.setTypingSpeed(Ge(t,"speed",333)),this.setTextCallback=xe(t,"setTextCallback",null),this.setTextCallbackScope=xe(t,"setTextCallbackScope",null),this.setTypingContent(xe(t,"text","")),this.typingIdx=xe(t,"typingIdx",0),this.insertIdx=xe(t,"insertIdx",null);var e=xe(t,"elapsed",null);return null!==e&&this.start(void 0,void 0,this.typingIdx,e),this}},{key:"shutdown",value:function(t){this.isShutdown||(this.freeTimer(),c(a(r.prototype),"shutdown",this).call(this,t));}},{key:"setTypeMode",value:function(t){return "string"==typeof t&&(t=De[t]),this.typeMode=t,this}},{key:"setTypeSpeed",value:function(t){return this.speed=t,this}},{key:"setTypingSpeed",value:function(t){return this.speed=t,this}},{key:"setTextWrapEnable",value:function(t){return void 0===t&&(t=!0),this.textWrapEnable=t,this}},{key:"text",get:function(){return this._text},set:function(t){var e=Re(t);this.textWrapEnable&&(e=function(t,e){switch(Pe(t)){case 0:t.style.syncFont(t.canvas,t.context),e=t.runWordWrap(e);break;case 1:e=t.getText(e,void 0,void 0,!0);break;case 2:e=t.setText(e).getTextBounds().wrappedText;}return e}(this.parent,e)),this._text=e;}},{key:"isTyping",get:function(){return null!==this.getTimer()}},{key:"isLastChar",get:function(){return this.typingIdx===this.textLen}},{key:"start",value:function(t,e,i,n){return void 0!==t&&this.setTypingContent(t),void 0!==e&&(this.speed=e),void 0===i&&(i=0),this.typingIdx=i+1,0===this.speed?this.stop(!0):(this.setText(""),this.startTimer(n)),this}},{key:"appendText",value:function(t){var e=this.text.concat(Re(t));return this.isTyping?this.setTypingContent(e):this.start(e,void 0,this.textLen),this}},{key:"stop",value:function(t){return this.getTimer()&&this.freeTimer(),t&&(this.typingIdx=this.textLen,this.setText(this.text),this.emit("type"),this.emit("complete",this,this.parent)),this}},{key:"pause",value:function(){var t=this.getTimer();return t&&(t.paused=!0),this}},{key:"resume",value:function(){var t=this.getTimer();return t&&(t.paused=!1),this}},{key:"setTypingContent",value:function(t){return this.text=t,this.textLen=this.getTextLength(this.text),this}},{key:"onTyping",value:function(){var t=this.getTypingString(this.text,this.typingIdx,this.textLen,this.typeMode);this.setText(t),this.emit("type"),this.isLastChar?(this.freeTimer(),this.emit("complete",this,this.parent)):(this.timer.delay=this.speed,this.typingIdx++);}},{key:"getTypingString",value:function(t,e,i,n){var s;if(0===n){var a=0,r=e;this.insertIdx=r,s=this.getSubString(t,a,r);}else if(1===n){a=(r=i)-e;this.insertIdx=0,s=this.getSubString(t,a,r);}else if(2===n){var o=i/2;r=(a=Math.floor(o-e/2))+e;this.insertIdx=e%2?e:0,s=this.getSubString(t,a,r);}else if(3===n){var u,c=Math.floor(e/2);if(c>0){a=(r=i)-c;u=this.getSubString(t,a,r);}else u="";var h,l=e-c;if(l>0){r=(a=0)+l;this.insertIdx=r,h=this.getSubString(t,a,r);}else h="",this.insertIdx=0;s=h+u;}return s}},{key:"startTimer",value:function(t){var e;return this.timer&&this.freeTimer(),void 0===t?e=0:(this.speed,e=t),this.timer=this.scene.time.addEvent({delay:1e-4,startAt:e,loop:!0,callback:this.onTyping,callbackScope:this}),this}},{key:"getTimer",value:function(){return this.timer}},{key:"freeTimer",value:function(){return this.timer&&(this.timer.remove(),this.timer=null),this}},{key:"setText",value:function(t){this.setTextCallback&&(t=this.setTextCallbackScope?this.setTextCallback.call(this.setTextCallbackScope,t,this.isLastChar,this.insertIdx):this.setTextCallback(t,this.isLastChar,this.insertIdx)),this.textWrapEnable?function(t,e){switch(Pe(t)){case 0:var i=(s=t.style).wordWrapWidth,n=s.wordWrapCallback;s.wordWrapWidth=0,s.wordWrapCallback=void 0,t.setText(e),s.wordWrapWidth=i,s.wordWrapCallback=n;break;case 1:var s,a=(s=t.style).wrapMode;s.wrapMode=0,t.setText(e),s.wrapMode=a;break;case 2:var r=t._maxWidth;t._maxWidth=0,t.setText(e),t._maxWidth=r;}}(this.parent,t):this.parent.setText(t);}},{key:"getTextLength",value:function(t){var e=this.parent;return e.getPlainText?e.getPlainText(t).length:t.length}},{key:"getSubString",value:function(t,e,i){var n=this.parent;return n.getSubString?n.getSubString(t,e,i):t.slice(e,i)}}]),r}(k),Re=function(t){return Array.isArray(t)?t=t.join("\n"):"number"==typeof t&&(t=t.toString()),t},De={"left-to-right":0,"right-to-left":1,"middle-to-sides":2,"sides-to-middle":3},Fe=!1,_e=function(t){s(r,t);var i=u(r);function r(){return e(this,r),i.apply(this,arguments)}return n(r,[{key:"setGO",value:function(t,e){return c(a(r.prototype),"setGO",this).call(this,t,e),t.setData("typing",!0),this}},{key:"clearText",value:function(){return this.gameObject.setText(""),this}},{key:"appendText",value:function(t){return this.gameObject.setText(this.gameObject.text+t),this}},{key:"setTypingSpeed",value:function(t){var e=this.gameObject;return e.typing||(e.typing=new Be(e)),e.typing.setTypingSpeed(t),this}},{key:"clearTyping",value:function(){var t=this.gameObject;return t.typing?t.typing.start(""):t.typing=new Be(t),this}},{key:"typing",value:function(t,e){var i=this.gameObject;return i.typing||(i.typing=new Be(i)),void 0!==e&&i.typing.setTypingSpeed(e),i.setData("typing",Fe),i.typing.once("complete",(function(){i.setData("typing",!0);})).appendText(t),this}}]),r}(Ot),Ve={};Object.assign(Ve,{clearText:function(t){return this.has(t)?(this.get(t).clearText(),this):this},appendText:function(t,e){return this.has(t)?(this.get(t).appendText(e),this):this},clearTyping:function(t){return this.has(t)?(this.get(t).clearTyping(),this):this},typing:function(t,e){return this.has(t)?(this.get(t).typing(e),this):this},appendTyping:function(t,e){return this.has(t)?(this.get(t).appendTyping(e),this):this},setTypingSpeed:function(t,e){return this.has(t)?(this.get(t).setTypingSpeed(e),this):this}});var Le=function(t){s(r,t);var i=u(r);function r(t,n){return e(this,r),void 0===n&&(n={}),n.BobClass=_e,i.call(this,t,n)}return n(r,[{key:"setCreateGameObjectCallback",value:function(t,e){return t&&"text"!==t||(t=Ie),c(a(r.prototype),"setCreateGameObjectCallback",this).call(this,t,e),this}}]),r}(ie),Ie=function(t){return t.add.text(0,0,"")};Object.assign(Le.prototype,Ve);var Ae=[function(t,e,i){var n=i.name,s=t.getGameObjectManager(n);t.on("".concat(n,".text"),(function(e){s.clearText(e),t.setContentCallback((function(t){s.appendText(e,t);}));}));},function(t,e,i){var n=i.name,s=t.getGameObjectManager(n);t.on("".concat(n,".typing"),(function(e,i){s.clearTyping(e),t.setContentCallback((function(t){void 0!==i&&s.setTypingSpeed(e,i),s.typing(e,t);}));}));}],We=function(t){void 0===t&&(t={}),t.name="text",t.parseCallbacks=Ae,this.addGameObjectManager(t,Le);},Ne=function(t,e){return 2===t.length&&t[0]===e},Ue={to:!0,yoyo:!0,from:!0,toLeft:!0,toRight:!0,toUp:!0,toDown:!0,yoyoLeft:!0,yoyoRight:!0,yoyoUp:!0,yoyoDown:!0,fromLeft:!0,fromRight:!0,fromUp:!0,fromDown:!0},Je=[function(t,e,i){var n=i.name,s=t.getGameObjectManager(n);e.on("+",(function(t){if(!e.skipEventFlag){var i,a=t.split(".");if(Ne(a,n)){i=a[1];for(var r=arguments.length,o=new Array(r>1?r-1:0),u=1;u<r;u++)o[u-1]=arguments[u];s.add.apply(s,[i].concat(o)),e.skipEvent();}}})).on("-",(function(t){if(!e.skipEventFlag){var i,a=t.split(".");Ne(a,n)&&(i=a[1],s.remove(i),e.skipEvent());}}));},function(t,e,i){var n=i.name,s=t.getGameObjectManager(n);e.on("-",(function(t){e.skipEventFlag||t===n&&(s.removeAll(),e.skipEvent());}));},function(t,e,i){var n=i.name,s=t.getGameObjectManager(n);e.on("+",(function(i){if(!e.skipEventFlag){var a,r,o=i.split(".");if(function(t,e){return 3===t.length&&t[0]===e}(o,n)){a=o[1],r=o[2];for(var u="".concat(n,".").concat(r),c=arguments.length,h=new Array(c>1?c-1:0),l=1;l<c;l++)h[l-1]=arguments[l];t.emit.apply(t,[u,a].concat(h)),t.listenerCount(u)>0||(s.hasMethod(a,r)?s.call.apply(s,[a,r].concat(h)):s.setProperty(a,r,h[0])),e.skipEvent();}}}));},function(t,e,i){var n=i.name,s=t.getGameObjectManager(n);e.on("+",(function(t,i,a,r,o){if(!e.skipEventFlag){var u,c,h,l,f=t.split(".");if(function(t,e){return 4===t.length&&t[0]===e&&Ue[t[3]]}(f,n)&&(u=f[1],c=f[2],"number"==typeof(h=s.getProperty(u,c)))){"number"==typeof r&&(o=r,r=void 0),(l=f[3]).endsWith("Left")||l.endsWith("Up")?l.startsWith("to")||l.startsWith("yoyo")?i=h-i:l.startsWith("from")&&(s.setProperty(u,c,h-i),i=h):l.endsWith("Right")||l.endsWith("Down")?l.startsWith("to")||l.startsWith("yoyo")?i=h+i:l.startsWith("from")&&(s.setProperty(u,c,h+i),i=h):"from"===l&&(s.setProperty(u,c,i),i=h);var d=l.startsWith("yoyo");s.easeProperty(u,c,i,a,r,o,d),e.skipEvent();}}}));}],ze=ne.addGameObjectManager,Xe={addGameObjectManager:function(t,e){void 0===t&&(t={}),t.name||console.warn("Parameter 'name' is required in TagPlayer.addGameObjectManager(config) method"),ze.call(this,t,e);for(var i=t.parseCallbacks,n=0,s=(i=i?[].concat(h(i),Je):Je).length;n<s;n++)i[n](this,this.parser,t);return this}},Ye=function(t){return function(t,e){return new Promise((function(i,n){t.once(e,(function(){i();}));}))}(t,"complete")},Ke={play:function(t){return this.parser.start(t),this},playPromise:function(t){var e=Ye(this);return this.play(t),e}},$e=function(t){switch(t){case"camera.fadein":case"camera.fadeout":case"camera.flash":case"camera.shake":case"camera.zoom":case"camera.rotate":case"camera.scroll":return !0;default:return !1}},He=function(t,e){var i=e.split(".");return t.gameObjectManagers.hasOwnProperty(i[0])},qe=function(t,e,i,n){var s=t.waitEventManager,a=e.split("."),r=a[0],o=t.getGameObjectManager(r),u="wait.".concat(r);switch(a.length){case 1:return s.waitGameObjectManagerEmpty(r),void t.emit(u);case 2:var c=a[1];return s.waitGameObjectDestroy(r,c),void t.emit(u,c);case 3:c=a[1];var h=a[2];if("number"==typeof o.getProperty(c,h))return s.waitGameObjectTweenComplete(r,c,h),void t.emit(u,c,h);var l=h,f=l.startsWith("!");return f&&(l=l.substring(1)),o.hasData(c,l)?(s.waitGameObjectDataFlag(r,c,l,!f),void t.emit(u,c,l)):void s.waitTime(0)}},Ze=Phaser.Input.Keyboard.KeyCodes,Qe=Phaser.Data.DataManager,ti={destroyDataManager:function(){this.data&&(this.data.destroy(),this.data=void 0);},setDataEnabled:function(){return this.data||(this.data=new Qe(this)),this},setData:function(t,e){return this.data||(this.data=new Qe(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new Qe(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new Qe(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new Qe(this)),this.data.get(t)}},ei={setClickTarget:function(t){return this.clickTarget=t,t?d(t)?this.clickEE=t.input:this.clickEE=t.setInteractive():this.clickEE=null,this},setTargetCamera:function(t){return this.targetCamera=t,this},setSkipSoundEffect:function(t){if(void 0===t&&(t=!0),this.skipSoundEffect=t,t){var e=this._soundManager;e&&e.fadeOutAllSoundEffects(100,!0);}return this},wait:function(t){return this.ignoreWait||(this.pause(),function(t,e,i,n){var s=t.waitEventManager;s.clearWaitCompleteCallbacks().addWaitCompleteCallback(i,n);for(var a=0,r=(e="string"==typeof e&&e.length>1&&-1!==e.indexOf("|")?e.split("|"):[e]).length;a<r;a++){var o=e[a];if(null==o||"wait"===o){var u=t.waitEventManager.getWaitCompleteTriggerCallback();t.emit("wait",u);}else if("number"!=typeof o&&isNaN(o))if("click"===o)s.waitClick(),t.emit("wait.click");else if("se"===o){s.waitSoundEffectComplete();var c=t.soundManager.getLastSoundEffect();t.emit("wait.music",c);}else "se2"===o?(s.waitSoundEffect2Complete(),c=t.soundManager.getLastSoundEffect2(),t.emit("wait.music",c)):"bgm"===o?(s.waitBackgroundMusicComplete(),c=t.soundManager.getBackgroundMusic(),t.emit("wait.music",c)):"bgm2"===o?(s.waitBackgroundMusic2Complete(),c=t.soundManager.getBackgroundMusic2(),t.emit("wait.music",c)):Ze.hasOwnProperty(o.toUpperCase())?(s.waitKeyDown(o),t.emit("wait.keydown",o)):$e(o)?(s.waitCameraEffectComplete(o),t.emit("wait.camera",o)):He(t,o)?qe(t,o):(u=t.waitEventManager.getWaitCompleteTriggerCallback(),t.emit("wait.".concat(o),u));else {var h=parseFloat(o);s.waitTime(h),t.emit("wait.time",h);}}}(this,t,this.resume,this)),this}};Object.assign(ei,Ke,{pause:function(){return this.parser.pause(),this},pauseUntilEvent:function(t,e){return this.parser.pauseUntilEvent(t,e),this}},{resume:function(){return this.parser.next(),this}},Xe,{getSprite:function(t){return this.getGameObject("sprite",t)},addSprite:function(t,e){return this.addGameObject("sprite",t,e),this}},{getTextGameObject:function(t){return this.getGameObject("text",t)},addTextGameObject:function(t,e){return this.addGameObject("text",t,e),this}},{setContentCallback:function(t,e){return this.contentCallback=t,this.contentCallbackScope=e,this}},ti);var ii=Phaser.Events.EventEmitter,ni=Phaser.Utils.Objects.GetValue,si=function(t){s(r,t);var i=u(r);function r(t,n){var s;e(this,r),void 0===n&&(n={}),(s=i.call(this)).scene=t,s.initManagers(t,n),s.parser=new ye(o(s),ni(n,"parser",void 0));var a=ni(n,"sprites");!1!==a&&null!==a&&Se.call(o(s),a);var u=ni(n,"texts");return !1!==u&&null!==u&&We.call(o(s),u),s}return n(r,[{key:"isPlaying",get:function(){return this.parser.isRunning}},{key:"targetCamera",get:function(){return this.waitEventManager.targetCamera}},{key:"clickTarget",get:function(){return this.waitEventManager.clickTarget}},{key:"spriteManager",get:function(){return this.getGameObjectManager("sprite")}},{key:"textManager",get:function(){return this.getGameObjectManager("text")}},{key:"gameObjectManagerNames",get:function(){var t=[];for(var e in this.gameObjectManagers)t.push(e);return t}},{key:"destroy",value:function(t){this.scene&&(c(a(r.prototype),"destroy",this).call(this),this.destroyManagers(t),this.scene=void 0);}},{key:"timeScale",get:function(){return this.getTimeScale()},set:function(t){this.setTimeScale(t);}}]),r}(function(t){var i=function(t){s(a,t);var i=u(a);function a(){return e(this,a),i.apply(this,arguments)}return n(a)}(t),a={initManagers:kt,setTimeScale:bt,getTimeScale:Et,destroyManagers:Mt};return Object.assign(i.prototype,a,ne,se),i}(ii));return Object.assign(si.prototype,ei),function(t){s(a,Phaser.Plugins.BasePlugin);var i=u(a);function a(t){return e(this,a),i.call(this,t)}return n(a,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this);}},{key:"add",value:function(t,e){return new si(t,e)}}]),a}()}));
