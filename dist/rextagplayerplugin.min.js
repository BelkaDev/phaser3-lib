!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rextagplayerplugin=e()}(void 0,function(){function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function V(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){t=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0===i)return("string"===e?String:Number)(t);i=i.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"==typeof t?t:String(t)}(n.key),n)}}function o(t,e,i){return e&&V(t.prototype,e),i&&V(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function L(t,e){return(L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(i){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=f(i),e=(t=n?(t=f(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}}function g(){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n)return(n=Object.getOwnPropertyDescriptor(n,e)).get?n.get.call(arguments.length<3?t:i):n.value}).apply(this,arguments)}function u(t){return function(t){if(Array.isArray(t))return I(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){var i;if(t)return"string"==typeof t?I(t,e):"Map"===(i="Object"===(i=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:i)||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?I(t,e):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function A(t){return t instanceof ut}function W(t){return t instanceof Tt}function i(t,e,i,n,s){W(t)&&(s=n,n=i,i=e,e=t,t=void 0);var a,n={mode:0,volume:{start:s=void 0===s?0:s,end:n=void 0===n?1:n},duration:i};(e="string"==typeof e?t.sys.sound.add(e):e).hasOwnProperty("_fade")?(a=e._fade).stop().resetFromJSON(n):(a=new Ct(t,e,n),e._fade=a),a.start(),e.isPlaying||e.setVolume(s).play()}function n(t,e,i,n){W(t)&&(n=i,i=e,e=t,t=void 0);var s,n={mode:(n=void 0===n?!0:n)?2:1,volume:{start:e.volume,end:0},duration:i};e.hasOwnProperty("_fade")?(s=e._fade).stop().resetFromJSON(n):(s=new Ct(t,e,n),e._fade=s),s.start(),e.isPlaying||e.play()}function s(t,e,i){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1===e.indexOf("."))return i;for(var n=e.split("."),s=t,a=i,r=0;r<n.length;r++){if(!s.hasOwnProperty(n[r])){a=i;break}a=s[n[r]],s=s[n[r]]}return a}return i}function N(t,e){this.managersScene=t;var i=Ut(e,"sounds");return!1!==i&&(this.soundManager=new Bt(t,i)),this.gameObjectManagers={},this.timeline=new Wt(this),this.waitEventManager=new Nt(this,e),this}function U(t){for(var e in this.timeline.timeScale=t,this.gameObjectManagers)this.gameObjectManagers[e].setTimeScale(t);return this}function J(){return this.timeline.timeScale}function z(t){for(var e in this.waitEventManager.destroy(),this.waitEventManager=void 0,this.soundManager&&this.soundManager.destroy(),this.soundManager=void 0,this.gameObjectManagers)this.gameObjectManagers[e].destroy(t),delete this.gameObjectManagers[e];this.timeline&&this.timeline.destroy(),this.timeline=void 0,this.managersScene=void 0}function X(t){return t>>16&255}function Y(t){return t>>8&255}function K(t){return 255&t}function $(e,i){var n,s,a;e.hasOwnProperty("tintR")||(n=X(i=void 0===i?16777215:i),s=Y(i),a=K(i),Object.defineProperty(e,"tint",{get:function(){return i},set:function(t){t=16777215&Math.floor(t),e.setTint&&e.setTint(t),i!==t&&(n=X(i=t),s=Y(i),a=K(i))}}),Object.defineProperty(e,"tintR",{get:function(){return n},set:function(t){t=255&Math.floor(t),n!==t&&(n=t,e.tint=(255&t)<<16|i&zt)}}),Object.defineProperty(e,"tintG",{get:function(){return s},set:function(t){t=255&Math.floor(t),s!==t&&(s=t,e.tint=(255&t)<<8|i&Xt)}}),Object.defineProperty(e,"tintB",{get:function(){return a},set:function(t){t=255&Math.floor(t),a!==t&&(a=t,e.tint=255&t|i&Yt)}}),Object.defineProperty(e,"tintGray",{get:function(){return Math.floor((n+s+a)/3)},set:function(t){t=255&Math.floor(t),n===t&&s===t&&a===t||(a=s=n=t,e.tint=(255&t)<<16|(255&t)<<8|255&t)}}),e.tint=i)}function H(t,e,i,n,s,a){return void 0===a?a={}:!0===a&&(a=$t),"number"!=typeof i&&(n=i=0),a.x=s.x+s.width*t+i,a.y=s.y+s.height*e+n,a}function q(t,e,i,n,s,a,r){var o,u,c,h,l,f,d;function p(){r(i,n,s,a,e,t)}t.hasOwnProperty("vp")||("function"==typeof i&&(r=i,i=void 0),"function"==typeof s&&(r=s,s=void 0),void 0===i&&(i=.5),void 0===n&&(n=.5),void 0===s&&(s=0),void 0===a&&(a=0),void 0===r&&(r=H),(o=e).events||(u=new Kt,c=o.x,Object.defineProperty(o,"x",{get:function(){return c},set:function(t){c!==t&&(c=t,u.emit("update",o))}}),h=o.y,Object.defineProperty(o,"y",{get:function(){return h},set:function(t){h!==t&&(h=t,u.emit("update",o))}}),l=o.width,Object.defineProperty(o,"width",{get:function(){return l},set:function(t){l!==t&&(l=t,u.emit("update",o))}}),f=o.height,Object.defineProperty(o,"height",{get:function(){return f},set:function(t){f!==t&&(f=t,u.emit("update",o))}}),o.events=u),d=e.events,t.vp=e,d.on("update",p),t.once("destroy",function(){d.off("update",p),t.vp=void 0}),Object.defineProperty(t,"vpx",{get:function(){return i},set:function(t){i!==t&&(i=t,p())}}),Object.defineProperty(t,"vpy",{get:function(){return n},set:function(t){n!==t&&(n=t,p())}}),Object.defineProperty(t,"vpxOffset",{get:function(){return s},set:function(t){s!==t&&(s=t,p())}}),Object.defineProperty(t,"vpyOffset",{get:function(){return a},set:function(t){a!==t&&(a=t,p())}}),p())}function m(t){return void 0!==t.displayWidth?t.displayWidth:t.width}function v(t){return void 0!==t.displayHeight?t.displayHeight:t.height}function y(t,e,i){return void 0===i&&(i=!1),0!==t.rotation&&qt(e,t.x,t.y,t.rotation),i&&t.parentContainer&&t.parentContainer.getBoundsTransformMatrix().transformPoint(e.x,e.y,e),e}function Z(t,e,i){return e instanceof Qt||(i=e,e=void 0),void 0===i?i=new te:!0===i&&(i=ee),e?t.scale.getViewPort(e,i):t.scale.getViewPort(i)}function Q(i){var t=function(){l(e,i);var t=p(e);function e(){return h(this,e),t.apply(this,arguments)}return o(e)}();return Object.assign(t.prototype,{initManagers:N,setTimeScale:U,getTimeScale:J,destroyManagers:z},ie,ne),t}function tt(t){return"string"==typeof t&&(""===t?t=null:se.test(t)?t=parseFloat(t):ae.test(t)?t=parseInt(t,16):"false"===t?t=!1:"true"===t&&(t=!0)),t}function r(t){return t.replace(re,"\\$&").replace(oe,"\\x2d")}function et(t,e){return 3===t.length&&t[0]===e&&"play"===t[2]}function it(t){return t=Te(t)?je:Me(t)?Oe:Se}function nt(t,e){return 2===t.length&&t[0]===e}function st(t){return i=t,n="complete",new Promise(function(t,e){i.once(n,function(){t()})});var i,n}var at=Phaser.Scene,a=function(t){return t instanceof at},rt={setEventEmitter:function(t,e){return void 0===e&&(e=Phaser.Events.EventEmitter),this._privateEE=!0===t||void 0===t,this._eventEmitter=this._privateEE?new e:t,this},destroyEventEmitter:function(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter:function(){return this._eventEmitter},on:function(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function(t){return this._eventEmitter&&t&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]},eventNames:function(){return this._eventEmitter?this._eventEmitter.eventNames.apply(this._eventEmitter,arguments):[]}},ot=function(t){return null==t||"object"!==_(t)?null:a(t)?t:t.scene&&a(t.scene)?t.scene:t.parent&&t.parent.scene&&a(t.parent.scene)?t.parent.scene:null},ut=Phaser.Game,ct=Phaser.Utils.Objects.GetValue,ht=function(){function i(t,e){h(this,i),this.setParent(t),this.isShutdown=!1,this.setEventEmitter(ct(e,"eventEmitter",!0)),this.parent&&(this.parent===this.scene?this.scene.sys.events.once("shutdown",this.onEnvDestroy,this):this.parent===this.game?this.game.events.once("shutdown",this.onEnvDestroy,this):this.parent.once&&this.parent.once("destroy",this.onParentDestroy,this))}return o(i,[{key:"shutdown",value:function(t){this.isShutdown||(this.parent&&(this.parent===this.scene?this.scene.sys.events.off("shutdown",this.onEnvDestroy,this):this.parent===this.game?this.game.events.off("shutdown",this.onEnvDestroy,this):this.parent.once&&this.parent.off("destroy",this.onParentDestroy,this)),this.destroyEventEmitter(),this.parent=void 0,this.scene=void 0,this.game=void 0,this.isShutdown=!0)}},{key:"destroy",value:function(t){this.shutdown(t)}},{key:"onEnvDestroy",value:function(){this.destroy(!0)}},{key:"onParentDestroy",value:function(t,e){this.destroy(e)}},{key:"setParent",value:function(t){return this.parent=t,this.scene=ot(t),this.game=null==(t=t)||"object"!==_(t)?null:A(t)?t:A(t.game)?t.game:a(t)?t.sys.game:a(t.scene)?t.scene.sys.game:void 0,this}}]),i}(),lt=(Object.assign(ht.prototype,rt),Phaser.Utils.Objects.GetValue),ft=function(){l(n,ht);var i=p(n);function n(t,e){return h(this,n),(t=i.call(this,t,e))._isRunning=!1,t.isPaused=!1,t.tickingState=!1,t.setTickingMode(lt(e,"tickingMode",1)),t}return o(n,[{key:"boot",value:function(){2!==this.tickingMode||this.tickingState||this.startTicking()}},{key:"shutdown",value:function(t){this.isShutdown||(this.stop(),this.tickingState&&this.stopTicking(),g(f(n.prototype),"shutdown",this).call(this,t))}},{key:"setTickingMode",value:function(t){"string"==typeof t&&(t=dt[t]),this.tickingMode=t}},{key:"startTicking",value:function(){this.tickingState=!0}},{key:"stopTicking",value:function(){this.tickingState=!1}},{key:"isRunning",get:function(){return this._isRunning},set:function(t){this._isRunning!==t&&(this._isRunning=t,1===this.tickingMode)&&t!=this.tickingState&&(t?this.startTicking():this.stopTicking())}},{key:"start",value:function(){return this.isPaused=!1,this.isRunning=!0,this}},{key:"pause",value:function(){return this.isRunning&&(this.isPaused=!0,this.isRunning=!1),this}},{key:"resume",value:function(){return this.isPaused&&(this.isRunning=!0),this}},{key:"stop",value:function(){return this.isPaused=!1,this.isRunning=!1,this}},{key:"complete",value:function(){this.isPaused=!1,this.isRunning=!1,this.emit("complete",this.parent,this)}}]),n}(),dt={no:0,lazy:1,always:2},pt=Phaser.Utils.Objects.GetValue,gt=function(){l(s,ft);var n=p(s);function s(t,e){h(this,s);var i=(t=n.call(this,t,e)).scene?"update":"step";return t.tickEventName=pt(e,"tickEventName",i),t.isSceneTicker=!mt(t.tickEventName),t}return o(s,[{key:"startTicking",value:function(){g(f(s.prototype),"startTicking",this).call(this),(this.isSceneTicker?this.scene.sys:this.game).events.on(this.tickEventName,this.update,this)}},{key:"stopTicking",value:function(){g(f(s.prototype),"stopTicking",this).call(this),this.isSceneTicker&&this.scene?this.scene.sys.events.off(this.tickEventName,this.update,this):this.game&&this.game.events.off(this.tickEventName,this.update,this)}}]),s}(),mt=function(t){return"step"===t||"poststep"===t},c=Phaser.Utils.Objects.GetValue,vt=Phaser.Math.Clamp,yt=function(){function e(t){h(this,e),this.resetFromJSON(t)}return o(e,[{key:"resetFromJSON",value:function(t){this.state=c(t,"state",k),this.timeScale=c(t,"timeScale",1),this.delay=c(t,"delay",0),this.repeat=c(t,"repeat",0),this.repeatCounter=c(t,"repeatCounter",0),this.repeatDelay=c(t,"repeatDelay",0),this.duration=c(t,"duration",0),this.nowTime=c(t,"nowTime",0),this.justRestart=c(t,"justRestart",!1)}},{key:"toJSON",value:function(){return{state:this.state,timeScale:this.timeScale,delay:this.delay,repeat:this.repeat,repeatCounter:this.repeatCounter,repeatDelay:this.repeatDelay,duration:this.duration,nowTime:this.nowTime,justRestart:this.justRestart}}},{key:"destroy",value:function(){}},{key:"setTimeScale",value:function(t){return this.timeScale=t,this}},{key:"setDelay",value:function(t){return this.delay=t=void 0===t?0:t,this}},{key:"setDuration",value:function(t){return this.duration=t,this}},{key:"setRepeat",value:function(t){return this.repeat=t,this}},{key:"setRepeatInfinity",value:function(){return this.repeat=-1,this}},{key:"setRepeatDelay",value:function(t){return this.repeatDelay=t,this}},{key:"start",value:function(){return this.nowTime=0<this.delay?-this.delay:0,this.state=0<=this.nowTime?E:b,this.repeatCounter=0,this}},{key:"stop",value:function(){return this.state=k,this}},{key:"update",value:function(t,e){this.state!==k&&this.state!==M&&0!==e&&0!==this.timeScale&&(this.nowTime+=e*this.timeScale,this.justRestart=!1,this.nowTime>=this.duration?-1===this.repeat||this.repeatCounter<this.repeat?(this.repeatCounter++,this.justRestart=!0,this.nowTime-=this.duration,0<this.repeatDelay&&(this.nowTime-=this.repeatDelay,this.state=kt)):(this.nowTime=this.duration,this.state=M):0<=this.nowTime&&(this.state=E))}},{key:"t",get:function(){var t;switch(this.state){case k:case b:case kt:t=0;break;case E:t=this.nowTime/this.duration;break;case M:t=1}return vt(t,0,1)},set:function(t){(t=vt(t,-1,1))<0?(this.state=b,this.nowTime=-this.delay*t):(this.state=E,this.nowTime=this.duration*t,1===t&&0!==this.repeat&&this.repeatCounter++)}},{key:"setT",value:function(t){return this.t=t,this}},{key:"isIdle",get:function(){return this.state===k}},{key:"isDelay",get:function(){return this.state===b}},{key:"isCountDown",get:function(){return this.state===E}},{key:"isRunning",get:function(){return this.state===b||this.state===E}},{key:"isDone",get:function(){return this.state===M}},{key:"isOddIteration",get:function(){return 1==(1&this.repeatCounter)}},{key:"isEvenIteration",get:function(){return 0==(1&this.repeatCounter)}}]),e}(),k=0,b=1,E=2,kt=3,M=-1,bt=function(){l(n,gt);var i=p(n);function n(t,e){return h(this,n),(t=i.call(this,t,e)).timer=new yt,t}return o(n,[{key:"shutdown",value:function(t){this.isShutdown||(g(f(n.prototype),"shutdown",this).call(this,t),this.timer.destroy(),this.timer=void 0)}},{key:"start",value:function(){return this.timer.start(),g(f(n.prototype),"start",this).call(this),this}},{key:"stop",value:function(){return this.timer.stop(),g(f(n.prototype),"stop",this).call(this),this}},{key:"complete",value:function(){return this.timer.stop(),g(f(n.prototype),"complete",this).call(this),this}}]),n}(),w=Phaser.Utils.Objects.GetValue,Et=Phaser.Utils.Objects.GetAdvancedValue,Mt=Phaser.Tweens.Builders.GetEaseFunction,wt=function(){l(e,bt);var t=p(e);function e(){return h(this,e),t.apply(this,arguments)}return o(e,[{key:"resetFromJSON",value:function(t){return this.timer.resetFromJSON(w(t,"timer")),this.setEnable(w(t,"enable",!0)),this.setTarget(w(t,"target",this.parent)),this.setDelay(Et(t,"delay",0)),this.setDuration(Et(t,"duration",1e3)),this.setEase(w(t,"ease","Linear")),this.setRepeat(w(t,"repeat",0)),this}},{key:"setEnable",value:function(t){return this.enable=t=null==t?!0:t,this}},{key:"setTarget",value:function(t){return void 0===t&&(t=this.parent),this.target=t,this}},{key:"setDelay",value:function(t){return this.delay=t,this}},{key:"setDuration",value:function(t){return this.duration=t,this}},{key:"setRepeat",value:function(t){return this.repeat=t,this}},{key:"setRepeatDelay",value:function(t){return this.repeatDelay=t,this}},{key:"setEase",value:function(t){return this.ease=t=void 0===t?"Linear":t,this.easeFn=Mt(t),this}},{key:"start",value:function(){return this.timer.isRunning||g(f(e.prototype),"start",this).call(this),this}},{key:"restart",value:function(){return this.timer.stop(),this.start.apply(this,arguments),this}},{key:"stop",value:function(t){return void 0===t&&(t=!1),g(f(e.prototype),"stop",this).call(this),t&&(this.timer.setT(1),this.updateGameObject(this.target,this.timer),this.complete()),this}},{key:"update",value:function(t,e){var i,n;return this.isRunning&&this.enable&&this.parent.active&&(i=this.target,(n=this.timer).update(t,e),n.isDelay||this.updateGameObject(i,n),this.emit("update",i,this),n.isDone)&&this.complete(),this}},{key:"updateGameObject",value:function(t,e){}}]),e}(),Tt=Phaser.Sound.BaseSound,Ot=Phaser.Utils.Objects.GetValue,St=Phaser.Utils.Objects.GetAdvancedValue,jt=Phaser.Math.Linear,Ct=function(){l(s,wt);var n=p(s);function s(t,e,i){return h(this,s),W(t)&&(i=e,e=t,t=void 0),e.active=!0,e.scene=t,e.game=e.manager.game,(t=n.call(this,e,i)).volume={},t.resetFromJSON(i),t}return o(s,[{key:"resetFromJSON",value:function(t){return g(f(s.prototype),"resetFromJSON",this).call(this,t),this.setMode(Ot(t,"mode",0)),this.setEnable(Ot(t,"enable",!0)),this.setVolumeRange(St(t,"volume.start",this.parent.volume),St(t,"volume.end",0)),this}},{key:"setMode",value:function(t){return"string"==typeof t&&(t=Pt[t]),this.mode=t,this}},{key:"setVolumeRange",value:function(t,e){return this.volume.start=t,this.volume.end=e,this}},{key:"start",value:function(){return this.timer.isRunning||(this.parent.setVolume(this.volume.start),this.timer.setDelay(this.delay).setDuration(this.duration),g(f(s.prototype),"start",this).call(this)),this}},{key:"updateGameObject",value:function(t,e){t.volume=jt(this.volume.start,this.volume.end,e.t)}},{key:"complete",value:function(){switch(g(f(s.prototype),"complete",this).call(this),this.mode){case 1:this.parent.stop();break;case 2:this.parent.destroy()}return this}}]),s}(),Pt={stop:1,destroy:2},xt=Phaser.Utils.Array.Remove,Gt=Phaser.Utils.Array.Remove,t={},T=(Object.assign(t,{setBackgroundMusicLoopValue:function(t){return this.backgroundMusicLoopValue=t,this},setBackgroundMusicFadeTime:function(t){return this.backgroundMusicFadeTime=t,this},getBackgroundMusic:function(){return this.backgroundMusic},setCurrentBackgroundMusic:function(t){return(this.backgroundMusic=t)&&(t.setLoop(this.backgroundMusicLoopValue),t.once("complete",function(){this.backgroundMusic===t&&(this.backgroundMusic.destroy(),this.backgroundMusic=void 0)},this).once("destroy",function(){this.backgroundMusic===t&&(this.backgroundMusic=void 0)},this),t.isPlaying||t.play()),this},playBackgroundMusic:function(t){return this.backgroundMusic&&this.backgroundMusic.key===t||(this.stopBackgroundMusic(),this.setCurrentBackgroundMusic(this.sound.add(t)),0<this.backgroundMusicFadeTime&&this.fadeInBackgroundMusic(this.backgroundMusicFadeTime)),this},pauseBackgroundMusic:function(){return this.backgroundMusic&&this.backgroundMusic.pause(),this},resumeBackgroundMusic:function(){return this.backgroundMusic&&this.backgroundMusic.resume(),this},stopBackgroundMusic:function(){return this.backgroundMusic&&(0<this.backgroundMusicFadeTime?this.fadeOutBackgroundMusic(this.backgroundMusicFadeTime,!0):(this.backgroundMusic.stop(),this.backgroundMusic.destroy(),this.backgroundMusic=void 0)),this},fadeInBackgroundMusic:function(t){return this.backgroundMusic&&i(this.backgroundMusic,t,this.backgroundMusicVolume,0),this},fadeOutBackgroundMusic:function(t,e){return this.backgroundMusic&&n(this.backgroundMusic,t,e),this},crossFadeBackgroundMusic:function(t,e){var i=this.backgroundMusicFadeTime;return this.backgroundMusicFadeTime=0,this.fadeOutBackgroundMusic(e,!0).playBackgroundMusic(t).fadeInBackgroundMusic(e),this.backgroundMusicFadeTime=i,this},setBackgroundMusicVolume:function(t){return this.backgroundMusicVolume=t,this}},{setBackgroundMusic2LoopValue:function(t){return this.backgroundMusic2LoopValue=t,this},setBackgroundMusic2FadeTime:function(t){return this.backgroundMusic2FadeTime=t,this},getBackgroundMusic2:function(){return this.backgroundMusic2},setCurrentBackgroundMusic2:function(t){return(this.backgroundMusic2=t)&&(t.setLoop(this.backgroundMusic2LoopValue),t.once("complete",function(){this.backgroundMusic2===t&&(this.backgroundMusic2.destroy(),this.backgroundMusic2=void 0)},this).once("destroy",function(){this.backgroundMusic2===t&&(this.backgroundMusic2=void 0)},this),t.isPlaying||t.play()),this},playBackgroundMusic2:function(t){return this.backgroundMusic2&&this.backgroundMusic2.key===t||(this.stopBackgroundMusic2(),this.setCurrentBackgroundMusic2(this.sound.add(t)),0<this.backgroundMusic2FadeTime&&this.fadeInBackgroundMusic2(this.backgroundMusic2FadeTime)),this},pauseBackgroundMusic2:function(){return this.backgroundMusic2&&this.backgroundMusic2.pause(),this},resumeBackgroundMusic2:function(){return this.backgroundMusic2&&this.backgroundMusic2.resume(),this},stopBackgroundMusic2:function(){return this.backgroundMusic2&&(0<this.backgroundMusic2FadeTime?this.fadeOutBackgroundMusic2(this.backgroundMusic2FadeTime,!0):(this.backgroundMusic2.stop(),this.backgroundMusic2.destroy(),this.backgroundMusic2=void 0)),this},fadeInBackgroundMusic2:function(t){return this.backgroundMusic2&&i(this.backgroundMusic2,t,this.backgroundMusic2Volume,0),this},fadeOutBackgroundMusic2:function(t,e){return this.backgroundMusic2&&n(this.backgroundMusic2,t,e),this},crossFadeBackgroundMusic2:function(t,e){var i=this.backgroundMusic2FadeTime;return this.backgroundMusic2FadeTime=0,this.fadeOutBackgroundMusic2(e,!0).playBackgroundMusic2(t).fadeInBackgroundMusic2(e),this.backgroundMusic2FadeTime=i,this},setBackgroundMusic2Volume:function(t){return this.backgroundMusic2Volume=t,this}},{getSoundEffects:function(){return this.soundEffects},getLastSoundEffect:function(){return this.soundEffects[this.soundEffects.length-1]},playSoundEffect:function(t){var e=this.sound.add(t);return e.setVolume(this.soundEffectsVolume),this.soundEffects.push(e),e.once("complete",function(){e.destroy(),this.sound&&xt(this.soundEffects,e)},this).once("destroy",function(){this.sound&&xt(this.soundEffects,e)},this).play(),this},fadeInSoundEffect:function(t){var e=this.getLastSoundEffect();return e&&i(e,t,this.soundEffectsVolume,0),this},fadeOutSoundEffect:function(t,e){var i=this.getLastSoundEffect();return i&&n(i,t,e),this},fadeOutAllSoundEffects:function(t,e){for(var i=this.soundEffects.length-1;0<=i;i--)n(this.soundEffects[i],t,e);return this},setSoundEffectVolume:function(t,e){return(e=void 0===e?!1:e)?(e=this.getLastSoundEffect())&&e.setVolume(t):this.soundEffectsVolume=t,this}},{getSoundEffects2:function(){return this.soundEffects2},getLastSoundEffect2:function(){return this.soundEffects2[this.soundEffects2.length-1]},playSoundEffect2:function(t){var e=this.sound.add(t);return e.setVolume(this.soundEffects2Volume),this.soundEffects2.push(e),e.once("complete",function(){e.destroy(),this.sound&&Gt(this.soundEffects2,e)},this).once("destroy",function(){this.sound&&Gt(this.soundEffects2,e)},this).play(),this},fadeInSoundEffect2:function(t){var e=this.getLastSoundEffect2();return e&&i(e,t,this.soundEffects2Volume,0),this},fadeOutSoundEffect2:function(t,e){var i=this.getLastSoundEffect2();return i&&n(i,t,e),this},fadeOutAllSoundEffects2:function(t,e){for(var i=this.soundEffects2.length-1;0<=i;i--)n(this.soundEffects2[i],t,e);return this},setSoundEffect2Volume:function(t,e){return(e=void 0===e?!1:e)?(e=this.getLastSoundEffect2())&&e.setVolume(t):this.soundEffects2Volume=t,this}}),Phaser.Utils.Objects.GetValue),Bt=function(){function i(t,e){h(this,i),this.sound=(a(t=t)?t.sys:t).sound,this.backgroundMusic=void 0,this._backgroundMusicVolume=T(e,"bgm.volume",1),this.setBackgroundMusicLoopValue(T(e,"bgm.loop",!0)),this.setBackgroundMusicFadeTime(T(e,"bgm.fade",500)),this.backgroundMusic2=void 0,this._backgroundMusic2Volume=T(e,"bgm2.volume",1),this.setBackgroundMusic2LoopValue(T(e,"bgm2.loop",!0)),this.setBackgroundMusic2FadeTime(T(e,"bgm2.fade",500)),this.soundEffects=[],this._soundEffectsVolume=T(e,"soundEffect.volume",1),this.soundEffects2=[],this._soundEffects2Volume=T(e,"soundEffect2.volume",1);t=T(e,"bgm.initial",void 0),t&&this.setCurrentBackgroundMusic(t),t=T(e,"bgm2.initial",void 0);t&&this.setCurrentBackgroundMusic2(t)}return o(i,[{key:"destroy",value:function(){if(this.backgroundMusic&&this.backgroundMusic.destroy(),this.backgroundMusic=void 0,this.backgroundMusic2&&this.backgroundMusic2.destroy(),this.backgroundMusic2=void 0,this.soundEffects.length)for(var t=this.soundEffects.length-1;0<=t;t--)this.soundEffects[t].destroy();if(this.soundEffects.length=0,this.soundEffects2.length)for(t=this.soundEffects2.length-1;0<=t;t--)this.soundEffects2[t].destroy();return this.soundEffects2.length=0,this.sound=void 0,this}},{key:"backgroundMusicVolume",get:function(){return this._backgroundMusicVolume},set:function(t){this._backgroundMusicVolume=t,this.backgroundMusic&&this.backgroundMusic.setVolume(t)}},{key:"backgroundMusic2Volume",get:function(){return this._backgroundMusic2Volume},set:function(t){this._backgroundMusic2Volume=t,this.backgroundMusic2&&this.backgroundMusic2.setVolume(t)}},{key:"soundEffectsVolume",get:function(){return this._soundEffectsVolume},set:function(t){this._soundEffectsVolume=t;for(var e=this.soundEffects,i=0,n=e.length;i<n;i++)e[i].setVolume(t)}}]),i}(),Dt=(Object.assign(Bt.prototype,t),Phaser.Utils.Objects.GetValue),Rt=function(){l(n,ft);var i=p(n);function n(t,e){return h(this,n),(t=i.call(this,t,e)).resetFromJSON(e),t.boot(),t}return o(n,[{key:"resetFromJSON",value:function(t){return this.isRunning=Dt(t,"isRunning",!1),this.timeScale=Dt(t,"timeScale",1),this.now=Dt(t,"now",0),this}},{key:"toJSON",value:function(){return{isRunning:this.isRunning,timeScale:this.timeScale,now:this.now,tickingMode:this.tickingMode}}},{key:"start",value:function(t){return void 0===t&&(t=0),this.delta=0,this.now=t,g(f(n.prototype),"start",this).call(this),this}},{key:"seek",value:function(t){return this.now=t,this}},{key:"setTimeScale",value:function(t){return this.timeScale=t,this}},{key:"tick",value:function(t){return t*=this.timeScale,this.now+=t,this.delta=t,this.emit("update",this.now,this.delta),this}}]),n}(),Ft=function(){l(e,Rt);var t=p(e);function e(){return h(this,e),t.apply(this,arguments)}return o(e,[{key:"startTicking",value:function(){g(f(e.prototype),"startTicking",this).call(this),this.scene.sys.events.on("update",this.update,this)}},{key:"stopTicking",value:function(){g(f(e.prototype),"stopTicking",this).call(this),this.scene&&this.scene.sys.events.off("update",this.update,this)}},{key:"update",value:function(t,e){return this.isRunning&&0!==this.timeScale&&this.tick(e),this}}]),e}(),_t=Phaser.Math.Clamp,Vt=function(){function i(t,e){h(this,i),this.setTimeline(t).reset(e)}return o(i,[{key:"setTimeline",value:function(t){return this.timeline=t,this}},{key:"setName",value:function(t){return this.name=t,this}},{key:"setCallbacks",value:function(t,e,i,n){return this.target=t,this.onStart=e,this.onProgress=i,this.onComplete=n,this}},{key:"setDuration",value:function(t,e){return void 0===e&&(e=!1),this.duration=t,this.remainder=t,this.t=0,this.yoyo=e,this}},{key:"setPaused",value:function(t){return this.isPaused=t,this}},{key:"pause",value:function(){return this.isPaused=!0,this}},{key:"resume",value:function(){return this.isPaused=!1,this}},{key:"setRemoved",value:function(t){return this.removed=t,this}},{key:"remove",value:function(){return this.removed=!0,this}},{key:"seek",value:function(t){return this.remainder=this.duration*(1-t),this}},{key:"reset",value:function(t){return this.setName(t.name).setDuration(t.duration,t.yoyo).setCallbacks(t.target,t.onStart,t.onProgress,t.onComplete).setPaused(!1).setRemoved(!1),this}},{key:"onFree",value:function(){this.setTimeline().setCallbacks()}},{key:"getProgress",value:function(){var t,e,i=1-this.remainder/this.duration,i=_t(i,0,1);return this.yoyo&&((t=i)<=(e=void 0===e?.5:e)?t/=e:t=1-(t-e)/(1-e),i=t),i}},{key:"setProgress",value:function(t){t=_t(t,0,1),this.remainder=this.duration*(1-t)}},{key:"runCallback",value:function(t){t&&t(this.target,this.t,this)}},{key:"update",value:function(t,e){if(this.removed)return!0;if(this.isPaused)return!1;this.remainder-=e,this.t=this.getProgress(),this.runCallback(this.onProgress);e=this.remainder<=0;return e&&this.runCallback(this.onComplete),e}}]),i}(),Lt=function(){function t(){h(this,t),this.items=[]}return o(t,[{key:"destroy",value:function(){this.clear(),this.items=void 0}},{key:"pop",value:function(){return 0<this.items.length?this.items.pop():null}},{key:"push",value:function(t){return this.items.push(t),this}},{key:"pushMultiple",value:function(t){return this.items.push.apply(this.items,t),t.length=0,this}},{key:"clear",value:function(){return this.items.length=0,this}}]),t}(),t=function(){l(e,Lt);var t=p(e);function e(){return h(this,e),t.apply(this,arguments)}return o(e,[{key:"allocate",value:function(){return this.pop()}},{key:"free",value:function(t){t.onFree(),this.push(t)}},{key:"freeMultiple",value:function(t){for(var e=0,i=t.length;e<i;e++)this.free(t[e]);return this}}]),e}(),It=Phaser.Utils.Objects.GetValue,At=new t,Wt=function(){l(r,Ft);var i=p(r);function r(t,e){return h(this,r),(t=i.call(this,t,e)).addedTimers=[],t.timers=[],t.timerPool=It(e,"pool",At),t}return o(r,[{key:"shutdown",value:function(){this.isShutdown||(this.timerPool.freeMultiple(this.addedTimers).freeMultiple(this.timers),this.timerPool=void 0,this.addedTimers=void 0,this.timers=void 0,g(f(r.prototype),"shutdown",this).call(this))}},{key:"addTimer",value:function(t){var e=this.timerPool.allocate();return e?e.setTimeline(this).reset(t):e=new Vt(this,t),this.addedTimers.push(e),e.runCallback(e.onStart),this.isRunning||this.start(),e}},{key:"delayCall",value:function(t,n,s,a){return this.addTimer({duration:t,onComplete:function(t,e,i){(s=void 0===s?[]:s).push(i),n.apply(a,s)}})}},{key:"delayEvent",value:function(t,e){this.removeDelayEvent(e);var i=this.delayCall(t,function(){this.removeDelayEvent(e),this.emit(e)},[],this);return this.once("_remove.".concat(e),function(){i.remove(),i=void 0}),this}},{key:"removeDelayEvent",value:function(t){return this.emit("_remove.".concat(t)),this}},{key:"getTimers",value:function(t){for(var e=[],i=[this.addedTimers,this.timers],n=0,s=i.length;n<s;n++)for(var a=i[n],r=0,o=a.length;r<o;r++){var u=a[r];u.name===t&&e.push(u)}return e}},{key:"update",value:function(t,e){if(g(f(r.prototype),"update",this).call(this,t,e),this.isRunning){(t=this.timers).push.apply(t,u(this.addedTimers));for(var i=[],n=this.addedTimers.length=0,s=this.timers.length;n<s;n++){var a=this.timers[n];a.update(this.now,this.delta)?this.timerPool.free(a):i.push(a)}this.timers=i,0===this.timers.length&&0===this.addedTimers.length&&this.complete()}}}]),r}(),O="_remove.wait",t={waitTime:function(t){var e=this.parent.timeline;return e.delayEvent(t,"delay"),this.parent.once(O,function(){e.removeDelayEvent("delay")}),this.waitEvent(e,"delay")}},e={setClickTarget:function(t){(this.clickTarget=t)?a(t)?this.clickEE=t.input:this.clickEE=t.setInteractive():this.clickEE=null},waitClick:function(){return this.clickEE?this.waitEvent(this.clickEE,"pointerdown"):this.waitTime(0)},waitKeyDown:function(t){var e=this.scene.input.keyboard;return"string"==typeof t?this.waitEvent(e,"keydown-".concat(t.toUpperCase())):this.waitEvent(e,"keydown")}},S={waitGameObjectTweenComplete:function(t,e,i){t=this.parent.getGameObjectTweenTask(t,e,i);return t?this.waitEvent(t,"complete"):this.waitTime(0)},waitGameObjectDataFlag:function(t,e,i,n){var s,a,r=this.parent.getGameObject(t,e);return!r||r.getData(i)===n?this.waitTime(0):(s="changedata-".concat(i),r.on(s,a=function(t,e,i){(e=!!e)===n&&t.emit("_dataFlagMatch")}),this.parent.once(O,function(){r.off(s,a)}),this.waitEvent(r,"_dataFlagMatch"))},waitGameObjectDestroy:function(t,e){t=this.parent.getGameObject(t,e);return t?this.waitEvent(t,"destroy"):this.waitTime(0)},waitGameObjectManagerEmpty:function(t){if(t)return(t=this.parent.getGameObjectManager(t))?this.waitEvent(t,"empty"):this.waitTime(0);var e,i=this.parent.gameObjectManagers,n=!1;for(e in i)n=!0,this.waitEvent(i[e],"empty");return n?this.parent:this.waitTime(0)}},Nt=function(){function i(t,e){h(this,i),this.parent=t,this.waitCompleteEventName=s(e,"completeEventName","_wait.complete"),this.setClickTarget(s(e,"clickTarget",this.scene)),this.setTargetCamera(s(e,"camera",this.scene.cameras.main)),this.waitId=0}return o(i,[{key:"destroy",value:function(){this.removeWaitEvents(),this.clearWaitCompleteCallbacks(),this.setClickTarget(),this.setTargetCamera()}},{key:"scene",get:function(){return this.parent.managersScene}},{key:"waitEvent",value:function(t,e,i){var n=this.getWaitCompleteTriggerCallback(i);return t.once(e,n,this),this.parent.once(O,function(){t.off(e,n,this)}),this.parent}},{key:"getWaitCompleteTriggerCallback",value:function(t){function r(){e<o.waitId||(o.waitId++,o.removeWaitEvents(),o.parent.emit(o.waitCompleteEventName))}var e=this.waitId,o=this;return(t=void 0===t?!0:t)?function(){var t,e,i,n,s,a;t=o.parent,e=0,i=r,(a=ot(t)).time.delayedCall(e,function(){a.sys.events.once("preupdate",function(){i.call(n,s)})})}:r}},{key:"removeWaitEvents",value:function(){return this.parent.emit(O),this}},{key:"addWaitCompleteCallback",value:function(t,e){return this.parent.on(this.waitCompleteEventName,t,e),this}},{key:"clearWaitCompleteCallbacks",value:function(){return this.parent.off(this.waitCompleteEventName),this}}]),i}(),Ut=(Object.assign(Nt.prototype,t,e,S,{setTargetCamera:function(t){return this.targetCamera=t,this},waitCameraEffectComplete:function(t){var e,i,n=this.targetCamera;if(!n)return this.waitTime(0);switch(t){case"camera.fadein":e=n.fadeEffect,i="camerafadeincomplete";break;case"camera.fadeout":e=n.fadeEffect,i="camerafadeoutcomplete";break;case"camera.flash":e=n.flashEffect,i="cameraflashcomplete";break;case"camera.shake":e=n.shakeEffect,i="camerashakecomplete";break;case"camera.zoom":e=n.zoomEffect,i="camerazoomcomplete";break;case"camera.rotate":e=n.rotateToEffect,i="camerarotatecomplete";break;case"camera.scroll":e=n.panEffect,i="camerapancomplete"}return e.isRunning?this.waitEvent(n,i):this.waitTime(0)}},{waitSoundEffectComplete:function(){var t;return this.parent.soundManager&&(t=this.parent.soundManager.getLastSoundEffect())?this.waitEvent(t,"complete"):this.waitTime(0)},waitSoundEffect2Complete:function(){var t;return this.parent.soundManager&&(t=this.parent.soundManager.getLastSoundEffect2())?this.waitEvent(t,"complete"):this.waitTime(0)},waitBackgroundMusicComplete:function(){var t;return this.parent.soundManager&&(t=this.parent.soundManager.getBackgroundMusic())?this.waitEvent(t,"complete"):this.waitTime(0)},waitBackgroundMusic2Complete:function(){var t;return this.parent.soundManager&&(t=this.parent.soundManager.getBackgroundMusic2())?this.waitEvent(t,"complete"):this.waitTime(0)}},{waitAny:function(t){if(!t)return this.waitTime(0);var e,i=!1;for(e in t)switch(e){case"time":i=!0,this.waitTime(t.time);break;case"click":i=!0,this.waitClick(t.key);break;case"key":i=!0,this.waitKeyDown(t.key);break;case"camera":i=!0,this.waitCameraEffectComplete(t.camera);break;case"bgm":i=!0,this.waitBackgroundMusicComplete();break;case"bgm2":i=!0,this.waitBackgroundMusic2Complete();break;case"se":i=!0,this.waitSoundEffectComplete();break;case"se2":i=!0,this.waitSoundEffect2Complete();break;default:var n=e.split(".");if(2===n.length){var s=n[0],n=n[1],a=this.parent.getGameObjectManager(void 0,s);if(!a)continue;if("number"==typeof a.getProperty(s,n)){i=!0,this.waitGameObjectTweenComplete(void 0,s,n);continue}var r=n,o=r.startsWith("!");o&&(r=r.substring(1)),a.hasData(s,n)&&(i=!0,this.waitGameObjectDataFlag(void 0,s,r,!o))}}return i||this.waitTime(0),this.parent}}),Phaser.Utils.Objects.GetValue),t={hasProperty:function(t){var e=this.gameObject;return!!e.hasOwnProperty(t)||void 0!==e[t]},getProperty:function(t){return this.gameObject[t]},setProperty:function(t,e){return this.gameObject[t]=e,this},easeProperty:function(t,e,i,n,s,a,r){var o=this.tweens,u=o[t],c=(u&&u.remove(),this.gameObject),i={targets:c,duration:i,ease:n,repeat:s,yoyo:a,onComplete:function(){o[t].remove(),o[t]=null,r&&r(c,t)},onCompleteScope:this};return i[t]=e,(u=this.scene.tweens.add(i)).timeScale=this.timeScale,o[t]=u,this}},e={hasMethod:function(t){return"function"==typeof this.gameObject[t]},call:function(t){if(this.hasMethod(t)){for(var e=this.gameObject,i=arguments.length,n=new Array(1<i?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];e[t].apply(e,n)}return this}},j=function(){function n(t,e,i){h(this,n),this.GOManager=t,this.tweens={},this.setGO(e,i)}return o(n,[{key:"scene",get:function(){return this.GOManager.scene}},{key:"timeScale",get:function(){return this.GOManager.timeScale}},{key:"destroy",value:function(){this.freeGO(),this.GOManager=void 0}},{key:"freeTweens",value:function(){var t,e,i=this.tweens;for(e in i)(t=i[e])&&t.remove(),i[e]=null;return this}},{key:"freeGO",value:function(){return this.freeTweens(),this.gameObject.destroy(),this.gameObject=void 0,this}},{key:"setGO",value:function(t,e){return t.setName(e),this.gameObject=t,this.name=e,this.freeTweens(),this}},{key:"setTimeScale",value:function(t){var e,i=this.tweens;for(e in i){var n=i[e];n&&(n.timeScale=t)}return this}}]),n}(),Jt=(Object.assign(j.prototype,t,e,{hasData:function(t){var e=this.gameObject;return!!e.data&&e.data.has(t)},getData:function(t){return this.gameObject.getData(t)},setData:function(t,e){return this.gameObject.setData(t,e),this}}),{tint:0,alpha:1}),zt=65535,Xt=16711935,Yt=16776960,Kt=Phaser.Events.EventEmitter,$t={},Ht=Phaser.Utils.Array.Remove,C=(Phaser.Geom.Rectangle,Phaser.Math.Vector2),qt=Phaser.Math.RotateAround,P=void 0,x=Phaser.Utils.Objects.GetValue,Zt=function(t,e,i,n,s,a,r){var o,u,c,h,l,f;(t.getBounds||void 0!==t.width&&void 0!==t.height)&&(void 0===i&&(i=16777215),void 0===n&&(n=1),void 0===s&&(s=null),void 0===a&&(a=1),void 0===r&&(r=0),h=t,void 0===(l=G[0])?l=new C:!0===l&&(l=P=void 0===P?new C:P),(h=h.getTopLeft?h.getTopLeft(l):(l.x=h.x-m(h)*h.originX,l.y=h.y-v(h)*h.originY,y(h,l,c))).x-=r,h.y-=r,l=t,void 0===(c=G[1])?c=new C:!0===c&&(c=P=void 0===P?new C:P),(h=l.getTopRight?l.getTopRight(c):(c.x=l.x-m(l)*l.originX+m(l),c.y=l.y-v(l)*l.originY,y(l,c,o))).x+=r,h.y-=r,l=t,void 0===(c=G[2])?c=new C:!0===c&&(c=P=void 0===P?new C:P),(o=l.getBottomRight?l.getBottomRight(c):(c.x=l.x-m(l)*l.originX+m(l),c.y=l.y-v(l)*l.originY+v(l),y(l,c,u))).x+=r,o.y+=r,h=t,void 0===(l=G[3])?l=new C:!0===l&&(l=P=void 0===P?new C:P),(c=h.getBottomLeft?h.getBottomLeft(l):(l.x=h.x-m(h)*h.originX,l.y=h.y-v(h)*h.originY+v(h),y(h,l,f))).x-=r,c.y+=r,null!==s&&e.fillStyle(s,a).fillPoints(G,!0,!0),null!==i)&&e.lineStyle(n,i).strokePoints(G,!0,!0)},G=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],S={drawGameObjectsBounds:function(h,l){return this.forEachGO(function(t){if(t.drawBounds)t.drawBounds(h,l);else{var e,i,n,s,a,r=t,o=h,t=l;if("number"==typeof t?e=t:(e=x(t,"color"),i=x(t,"lineWidth"),n=x(t,"fillColor"),s=x(t,"fillAlpha",1),a=x(t,"padding",0)),Array.isArray(r))for(var u=0,c=r.length;u<c;u++)Zt(r[u],o,e,i,n,s,a);else Zt(r,o,e,i,n,s,a)}}),this}},Qt=(Object.assign(S,{setGOFadeMode:function(t){return this.fadeMode=t="string"==typeof t?Jt[t]:t,this},setGOFadeTime:function(t){return this.fadeTime=t,this},hasTintFadeEffect:function(t){return(void 0===this.fadeMode||0===this.fadeMode)&&0<this.fadeTime&&void 0!==t.setTint},hasAlphaFadeEffect:function(t){return(void 0===this.fadeMode||1===this.fadeMode)&&0<this.fadeTime&&void 0!==t.setAlpha},fadeBob:function(t,e,i,n){var s=t.gameObject;return this.hasTintFadeEffect(s)?(void 0!==e&&t.setProperty("tintGray",255*e),t.easeProperty("tintGray",Math.floor(255*i),this.fadeTime,"Linear",0,!1,n)):this.hasAlphaFadeEffect(s)?(void 0!==e&&t.setProperty("alpha",e),t.easeProperty("alpha",i,this.fadeTime,"Linear",0,!1,n)):n&&n(s),this}},{has:function(t){return this.bobs.hasOwnProperty(t)},exists:function(t){return this.bobs.hasOwnProperty(t)},get:function(t){return this.bobs[t]},getGO:function(t){t=this.get(t);return t?t.gameObject:null},addGO:function(t,e){this.remove(t,!0),this.hasTintFadeEffect(e)&&$(e),this.viewportCoordinateEnable&&q(e,this.viewport),e.once("destroy",function(){Ht(this.removedGOs,e),this.isEmpty&&this.emit("empty")},this);var i=new this.BobClass(this,e,t);return this.bobs[t]=i,this},add:function(t){for(var e=this.createGameObjectCallback,i=this.createGameObjectScope,n=arguments.length,s=new Array(1<n?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];e=e.call.apply(e,[i,this.scene].concat(s)),this.addGO(t,e),i=this.get(t);return this.fadeBob(i,0,1),this},forEachGO:function(t,e){for(var i in this.bobs){var n=this.bobs[i].gameObject,n=e?t.call(e,n,i,this):t(n,i,this);if(n)break}return this}},{remove:function(t,e){var i;return this.has(t)&&(i=this.get(t),delete this.bobs[t],this.removedGOs.push(i.gameObject),e?i.destroy():this.fadeBob(i,void 0,0,function(){i.destroy()})),this},removeAll:function(){for(var t in this.bobs)this.remove(t);return this},clear:function(t){void 0===t&&(t=!0);var e,i=this.bobs;for(e in i)t&&i[e].destroy(),delete i[e];return this.removedGOs.length=0,this}},{hasProperty:function(t,e){return!!this.has(t)&&this.get(t).hasProperty(e)},getProperty:function(t,e){if(this.has(t))return this.get(t).getProperty(e)},isNumberProperty:function(t,e){return"number"==typeof this.getProperty(t,e)},setProperty:function(t,e,i){return this.has(t)&&(this.symbols&&"string"==typeof i&&this.isNumberProperty(t,e)&&(i in this.symbols?i=this.symbols[i]:console.warn("Can't find symbol ".concat(i))),this.get(t).setProperty(e,i)),this},easeProperty:function(t,e,i,n,s,a,r,o){return this.has(t)&&(void 0===n&&(n=1e3),void 0===s&&(s="Linear"),void 0===a&&(a=0),void 0===r&&(r=!1),this.symbols&&"string"==typeof i&&this.isNumberProperty(t,e)&&(i in this.symbols?i=this.symbols[i]:console.warn("Can't find symbol ".concat(i))),this.get(t).easeProperty(e,i,n,s,a,r,o)),this},hasTweenTask:function(t,e){return!!this.has(t)&&this.get(t).tweens.hasOwnProperty(e)},getTweenTask:function(t,e){return this.has(t)&&this.get(t).tweens[e]||null}},{hasMethod:function(t,e){return!!this.has(t)&&this.get(t).hasMethod(e)},call:function(t,e){var i;if(this.has(t)){for(var n=arguments.length,s=new Array(2<n?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a];(i=this.get(t)).call.apply(i,[e].concat(s))}return this}},{hasData:function(t,e){return!!this.has(t)&&this.get(t).hasData(e)},getData:function(t,e){if(this.has(t))return this.get(t).getData(e)},setData:function(t,e,i){return this.has(t)&&this.get(t).setData(e,i),this}}),Phaser.Cameras.Scene2D.BaseCamera),te=Phaser.Geom.Rectangle,ee=new te,B=Phaser.Utils.Objects.GetValue,D=function(){function i(t,e){h(this,i),this.scene=t,this.BobClass=B(e,"BobClass",j),this.setCreateGameObjectCallback(B(e,"createGameObject"),B(e,"createGameObjectScope")),this.setEventEmitter(B(e,"eventEmitter",void 0));t=B(e,"fade",500),"number"==typeof t?(this.setGOFadeMode(),this.setGOFadeTime(t)):(this.setGOFadeMode(B(t,"mode")),this.setGOFadeTime(B(t,"time",500))),t=B(e,"viewportCoordinate",!1);!1!==t?(this.setViewportCoordinateEnable(B(e,"enable",!0)),this.setViewport(B(t,"viewport"))):this.setViewportCoordinateEnable(!1),this.setSymbols(B(e,"symbols")),this.bobs={},this.removedGOs=[],this._timeScale=1}return o(i,[{key:"destroy",value:function(t){this.clear(!t),this.createGameObjectCallback=void 0,this.viewport=void 0,this.scene=void 0}},{key:"timeScale",get:function(){return this._timeScale},set:function(t){if(this._timeScale!==t){this._timeScale=t;var e,i=this.bobs;for(e in i)i[e].setTimeScale(t)}}},{key:"setTimeScale",value:function(t){return this.timeScale=t,this}},{key:"setCreateGameObjectCallback",value:function(t,e){return this.createGameObjectCallback=t,this.createGameObjectScope=e,this}},{key:"setViewportCoordinateEnable",value:function(t){return this.viewportCoordinateEnable=t=void 0===t?!0:t,this}},{key:"setViewport",value:function(t){return void 0===t&&(t=Z(this.scene,this.scene.cameras.main)),this.viewport=t,this}},{key:"setSymbols",value:function(t){return this.symbols=t,this}},{key:"isEmpty",get:function(){return function(t){for(var e in t)return!1;return!0}(this.bobs)&&0===this.removedGOs.length}}]),i}(),ie=(Object.assign(D.prototype,rt,S),{addGameObjectManager:function(t,e){void 0===e&&(e=D),(t=void 0===t?{}:t).createGameObjectScope||(t.createGameObjectScope=this);e=new e(this.managersScene,t);return this.gameObjectManagers[t.name]=e,this},getGameObjectManager:function(t,e){var i;if(t)return i=this.gameObjectManagers[t];for(t in this.gameObjectManagers)if((i=this.gameObjectManagers[t]).has(e))return i},getGameObjectManagerNames:function(){var t,e=[];for(t in this.gameObjectManagers)e.push(t);return e},getGameObjectManagerName:function(t){for(var e in this.gameObjectManagers)if(this.gameObjectManagers[e].has(t))return e}}),ne={createGameObject:function(t,e){for(var i,n=arguments.length,s=new Array(2<n?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a];return(i=this.getGameObjectManager(t,e)).add.apply(i,[e].concat(s)),this},destroyGameObject:function(t,e){t=this.getGameObjectManager(t,e);return void 0===e?t.removeAll():t.remove(e),this},callGameObjectMethod:function(t,e,i){for(var n,s=arguments.length,a=new Array(3<s?s-3:0),r=3;r<s;r++)a[r-3]=arguments[r];return(n=this.getGameObjectManager(t,e)).call.apply(n,[e,i].concat(a)),this},setGameObjectProperty:function(t,e,i,n){return this.getGameObjectManager(t,e).setProperty(e,i,n),this},easeGameObjectProperty:function(t,e,i,n,s,a,r,o){return this.getGameObjectManager(t,e).easeProperty(e,i,n,s,a,r,o),this},getGameObjectTweenTask:function(t,e,i){return this.getGameObjectManager(t,e).getTweenTask(e,i)},getGameObject:function(t,e,i){var n=this.getGameObjectManager(t,e);if("string"==typeof e)return n.getGO(e);t=e;for(e in void 0===i&&(i={}),t=void 0===e?n.bobs:t)i[e]=n.getGO(e);return i},addGameObject:function(t,e,i){var n=this.getGameObjectManager(t,e);if("string"==typeof e)n.addGO(e,i);else{var s=e;for(e in s)n.addGO(e,s[e])}return this},drawGameObjectsBounds:function(t,e,i){t instanceof Phaser.GameObjects.Graphics&&(i=e,e=t,t=void 0),void 0===t&&(t=this.getGameObjectManagerNames());for(var n=0,s=(t=Array.isArray(t)?t:[t]).length;n<s;n++)this.getGameObjectManager(t[n]).drawGameObjectsBounds(e,i);return this}},se=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,ae=/^0x[0-9A-F]+$/i,re=/[|\\{}()[\]^$+*?.]/g,oe=/-/g,ue=function(){function i(t){h(this,i),this.setEventEmitter(s(t,"eventEmitter",void 0)),this.setValueConverter(s(t,"valueConvert",!0)),this.setLoopEnable(s(t,"loop",!1)),this.setMultipleLinesTagEnable(s(t,"multipleLinesTag",!1));var e=s(t,"delimiters","<>");this.setDelimiters(e[0],e[1]),this.setTranslateTagNameCallback(s(t,"translateTagNameCallback")),this.isRunning=!1,this.isPaused=!1,this.skipEventFlag=!1,this.justCompleted=!1,this.lastTagStart=null,this.lastTagEnd=null,this.lastContent=null}return o(i,[{key:"shutdown",value:function(){this.destroyEventEmitter()}},{key:"destroy",value:function(){this.shutdown()}},{key:"setMultipleLinesTagEnable",value:function(t){return this.multipleLinesTagEnable=t=void 0===t?!0:t,this}},{key:"setDelimiters",value:function(t,e){void 0===e&&(e=t[1],t=t[0]),this.delimiterLeft=t,this.delimiterRight=e,t=r(this.delimiterLeft),e=r(this.delimiterRight);var i=this.multipleLinesTagEnable?"gs":"gi";return this.reSplit=RegExp("".concat(t,"(.+?)").concat(e),i),this}},{key:"setTranslateTagNameCallback",value:function(t){return this.translateTagNameCallback=t,this}},{key:"setValueConverter",value:function(t){return this.valueConverter=t=!0===t?tt:t||ce,this}},{key:"setLoopEnable",value:function(t){return this.loopEnable=t=void 0===t?!0:t,this}},{key:"setSource",value:function(t){return this.source=t,this}},{key:"resetIndex",value:function(t){return this.progressIndex=t=void 0===t?0:t,this.reSplit.lastIndex=t,this.lastTagStart=null,this.lastTagEnd=null,this.lastContent=null,this.justCompleted=!1,this.isRunning=!1,this}},{key:"start",value:function(t){return this.setSource(t).restart(),this}},{key:"restart",value:function(){this.resetIndex().next()}},{key:"next",value:function(){if(this.isPaused&&this.onResume(),!this.isRunning){if(this.isRunning=!0,!this.justCompleted){0===this.reSplit.lastIndex&&this.onStart();var t=this.source,e=t.length;for(this.reSplit.lastIndex=this.progressIndex;;){var i=this.reSplit.exec(t);if(!i){if(this.progressIndex<e&&(this.onContent(t.substring(this.progressIndex,e)),this.isPaused)){this.progressIndex=e;break}return this.onComplete(),void(this.isRunning=!1)}var n=this.reSplit.lastIndex,s=n-i[0].length;if(this.progressIndex<s&&(this.onContent(t.substring(this.progressIndex,s)),this.isPaused)){this.progressIndex=s;break}if(this.onTag(i[1]),this.progressIndex=n,this.isPaused)break}}this.isRunning=!1}return this}},{key:"skipEvent",value:function(){return this.skipEventFlag=!0,this}},{key:"pause",value:function(){return this.isPaused||this.onPause(),this}},{key:"pauseUntilEvent",value:function(t,e){return this.isPaused||(this.pause(),t.once(e,function(){this.next()},this)),this}},{key:"onContent",value:function(t){this.skipEventFlag=!1,this.emit("content",t),this.lastContent=t}},{key:"onTag",value:function(t){}},{key:"onStart",value:function(){this.isRunning=!0,this.emit("start",this)}},{key:"onComplete",value:function(){this.isRunning=!1,this.justCompleted=!0,this.emit("complete",this),this.loopEnable&&this.resetIndex()}},{key:"onPause",value:function(){this.isPaused=!0,this.emit("pause",this)}},{key:"onResume",value:function(){this.isPaused=!1,this.emit("resume",this)}}]),i}(),ce=function(t){return t},he=(Object.assign(ue.prototype,rt),function(){l(a,ue);var i=p(a);function a(t){h(this,a),(t=void 0===t?{}:t).hasOwnProperty("multipleLinesTag")||(t.multipleLinesTag=!1),(e=i.call(this,t)).setTagExpression(s(t,"regex.tag",void 0)),e.setValueExpression(s(t,"regex.value",void 0));var e,t=s(t,"delimiters","<>");return e.setDelimiters(t[0],t[1]),e}return o(a,[{key:"setTagExpression",value:function(t){return this.tagExpression=t=t||le,this}},{key:"setValueExpression",value:function(t){return this.valueExpression=t=t||le,this}},{key:"setDelimiters",value:function(t,e){g(f(a.prototype),"setDelimiters",this).call(this,t,e);var i,n,s="(".concat(this.tagExpression,")(=(").concat(this.valueExpression,"))?");return this.reTag=RegExp(s,"i"),this.tagExpression===le&&this.valueExpression===le||(s="".concat(this.tagExpression,"(=").concat(this.valueExpression,")?"),i="/".concat(this.tagExpression),t=r(this.delimiterLeft),e=r(this.delimiterRight),n=this.multipleLinesTagEnable?"gs":"gi",this.reSplit=RegExp("".concat(t,"((").concat(s,")|(").concat(i,"))").concat(e),n)),this}},{key:"onTag",value:function(t){var t=t.match(this.reTag),e=t[1],i="/"===e.charAt(0);i&&(e=e.substring(1,e.length)),this.translateTagNameCallback&&(e=this.translateTagNameCallback(e)),this.skipEventFlag=!1,i?(this.emit("-".concat(e)),this.skipEventFlag||this.emit("-",e),this.lastTagEnd=e):(i=function(t,e){if(null==t)return[];for(var i=t.split(","),n=0,s=i.length;n<s;n++)i[n]=e(i[n]);return i}(t[3],this.valueConverter),this.emit.apply(this,["+".concat(e)].concat(u(i))),this.skipEventFlag||this.emit.apply(this,["+",e].concat(u(i))),this.lastTagStart=e)}}]),a}()),le="[^=]+",fe=Phaser.Math.DegToRad,de=[function(e,i,t){i.on("+".concat("wait"),function(t){e.wait(t),i.skipEvent()}).on("-".concat("wait"),function(){i.skipEvent()}).on("+".concat("click"),function(){e.wait("click"),i.skipEvent()}).on("-".concat("click"),function(){i.skipEvent()})},function(i,n,t){n.on("+".concat("se"),function(t,e){this.skipSoundEffect||(i.soundManager.playSoundEffect(t),e&&i.soundManager.fadeInSoundEffect(e),n.skipEvent())}).on("-".concat("se"),function(){n.skipEvent()});n.on("+".concat("se2"),function(t,e){this.skipSoundEffect||(i.soundManager.playSoundEffect2(t),e&&i.soundManager.fadeInSoundEffect2(e),n.skipEvent())}).on("-".concat("se2"),function(){n.skipEvent()})},function(e,i,t){i.on("+".concat(n="se.fadein"),function(t){e.soundManager.fadeInSoundEffect(t),i.skipEvent()}).on("-".concat(n),function(){i.skipEvent()});var n="se2.fadein";i.on("+".concat(n),function(t){e.soundManager.fadeInSoundEffect2(t),i.skipEvent()}).on("-".concat(n),function(){i.skipEvent()})},function(i,n,t){n.on("+".concat(e="se.fadeout"),function(t,e){i.soundManager.fadeOutSoundEffect(t,e="stop"===e),n.skipEvent()}).on("-".concat(e),function(){n.skipEvent()});var e="se2.fadeout";n.on("+".concat(e),function(t,e){i.soundManager.fadeOutSoundEffect2(t,e="stop"===e),n.skipEvent()}).on("-".concat(e),function(){n.skipEvent()})},function(e,i,t){i.on("+".concat(n="se.volume"),function(t){e.soundManager.setSoundEffectVolume(t,!0),i.skipEvent()}).on("-".concat(n),function(){i.skipEvent()});var n="se2.volume";i.on("+".concat(n),function(t){e.soundManager.setSoundEffectVolume2(t,!0),i.skipEvent()}).on("-".concat(n),function(){i.skipEvent()})},function(i,n,t){n.on("+".concat("bgm"),function(t,e){i.soundManager.playBackgroundMusic(t),e&&i.soundManager.fadeInBackgroundMusic(e),n.skipEvent()}).on("-".concat("bgm"),function(){i.soundManager.stopBackgroundMusic(),n.skipEvent()});n.on("+".concat("bgm2"),function(t,e){i.soundManager.playBackgroundMusic2(t),e&&i.soundManager.fadeInBackgroundMusic2(e),n.skipEvent()}).on("-".concat("bgm2"),function(){i.soundManager.stopBackgroundMusic2(),n.skipEvent()})},function(e,i,t){i.on("+".concat(n="bgm.fadein"),function(t){e.soundManager.fadeInBackgroundMusic(t),i.skipEvent()}).on("-".concat(n),function(){i.skipEvent()});var n="bgm2.fadein";i.on("+".concat(n),function(t){e.soundManager.fadeInBackgroundMusic2(t),i.skipEvent()}).on("-".concat(n),function(){i.skipEvent()})},function(i,n,t){n.on("+".concat(e="bgm.fadeout"),function(t,e){i.soundManager.fadeOutBackgroundMusic(t,e="stop"===e),n.skipEvent()}).on("-".concat(e),function(){n.skipEvent()});var e="bgm2.fadeout";n.on("+".concat(e),function(t,e){i.soundManager.fadeOutBackgroundMusic2(t,e="stop"===e),n.skipEvent()}).on("-".concat(e),function(){n.skipEvent()})},function(i,n,t){n.on("+".concat(e="bgm.cross"),function(t,e){i.soundManager.crossFadeBackgroundMusic(t,e),n.skipEvent()}).on("-".concat(e),function(){n.skipEvent()});var e="bgm2.cross";n.on("+".concat(e),function(t,e){i.soundManager.crossFadeBackgroundMusic2(t,e),n.skipEvent()}).on("-".concat(e),function(){n.skipEvent()})},function(t,e,i){e.on("+".concat(n="bgm.pause"),function(){t.soundManager.pauseBackgroundMusic(),e.skipEvent()}).on("-".concat(n),function(){t.soundManager.resumeBackgroundMusic(),e.skipEvent()});var n="bgm2.pause";e.on("+".concat(n),function(){t.soundManager.pauseBackgroundMusic2(),e.skipEvent()}).on("-".concat(n),function(){t.soundManager.resumeBackgroundMusic2(),e.skipEvent()})},function(s,a,t){a.on("+".concat("camera.fadein"),function(t,e,i,n){s.targetCamera.fadeIn(t,e,i,n),a.skipEvent()})},function(s,a,t){a.on("+".concat("camera.fadeout"),function(t,e,i,n){s.targetCamera.fadeOut(t,e,i,n),a.skipEvent()})},function(i,n,t){n.on("+".concat("camera.shake"),function(t,e){i.targetCamera.shake(t,e),n.skipEvent()})},function(s,a,t){a.on("+".concat("camera.flash"),function(t,e,i,n){s.targetCamera.flash(t,e,i,n),a.skipEvent()})},function(n,s,t){var e="camera.zoom";s.on("+".concat(e),function(t){n.targetCamera.setZoom(t),s.skipEvent()}).on("+".concat(e,".to"),function(t,e,i){n.targetCamera.zoomTo(t,e,i),s.skipEvent()})},function(n,s,t){var e="camera.rotate";s.on("+".concat(e),function(t){n.targetCamera.setRotation(fe(t)),s.skipEvent()}).on("+".concat(e,".to"),function(t,e,i){t=fe(t),n.targetCamera.rotateTo(fe(t),!1,e,i),s.skipEvent()})},function(o,u,t){var e="camera.scroll";u.on("+".concat(e),function(t,e){o.targetCamera.setScroll(t,e),u.skipEvent()}).on("+".concat(e,".to"),function(t,e,i,n){var s=o.targetCamera,a=s.scrollX,r=s.scrollY;s.setScroll(t,e),t+=s.centerX,e+=s.centerY,s.setScroll(a,r),s.pan(t,e,i,n),u.skipEvent()})},function(n,s,t){s.on("content",function(t){var e,i;s.skipEventFlag||"\n"!==t&&(t=t.replaceAll("\\n","\n"),(e=n.contentCallback)&&((i=n.contentCallbackScope)?e.call(i,t):e(t),s.skipEvent()),n.emit("+".concat(s.lastTagStart,"#content"),t),n.emit("content",t))})},function(s,a,t){a.on("+",function(t){if(!a.skipEventFlag){for(var e=arguments.length,i=new Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];s.emit.apply(s,["+".concat(t),a].concat(i))}}).on("-",function(t){a.skipEventFlag||s.emit("-".concat(t),a)})}],pe=Phaser.Utils.Objects.GetValue,ge=function(){l(c,he);var u=p(c);function c(t,e){h(this,c),(e=void 0===e?{}:e).hasOwnProperty("delimiters")||(e.delimiters="[]"),i=u.call(this,e);for(var i,n=t,s=d(i),a=e,r=0,o=de.length;r<o;r++)de[r](n,s,a);return s.on("start",function(){n.emit("start",s)}).on("complete",function(){n.emit("complete",s)}),i.setCommentLineStartSymbol(pe(e,"comment","//")),i}return o(c,[{key:"setCommentLineStartSymbol",value:function(t){return this.commentLineStart=t,this}},{key:"start",value:function(t){return g(f(c.prototype),"start",this).call(this,function(t,e){for(var i=t.commentLineStart,n=e.split("\n"),s=0,a=n.length;s<a;s++){var r=n[s];""!==r&&(0===r.trim().length||i&&r.startsWith(i))&&(n[s]="")}return n.join("")}(this,t)),this}}]),c}(),me=function(){l(e,j);var t=p(e);function e(){return h(this,e),t.apply(this,arguments)}return o(e,[{key:"playAnimation",value:function(t){return this.gameObject.anims.timeScale=this.timeScale,this.gameObject.play(t),this}},{key:"stopAnimation",value:function(){return this.gameObject.stop(),this}},{key:"chainAnimation",value:function(t){return this.gameObject.chain(t),this}},{key:"pauseAnimation",value:function(){return this.gameObject.anims.pause(),this}},{key:"setTimeScale",value:function(t){return g(f(e.prototype),"setTimeScale",this).call(this,t),this.gameObject.anims&&(this.gameObject.anims.timeScale=t),this}}]),e}(),t={},ve=(Object.assign(t,{playAnimation:function(t,e){return this.has(t)||this.add(t),this.get(t).playAnimation(e),this},stopAnimation:function(t){return this.has(t)&&this.get(t).stopAnimation(),this},chainAnimation:function(t,e){return this.has(t)&&this.get(t).chainAnimation(e),this},pauseAnimation:function(t){return this.has(t)&&this.get(t).pauseAnimation(),this}}),function(){l(n,D);var i=p(n);function n(t,e){return h(this,n),(e=void 0===e?{}:e).BobClass=me,i.call(this,t,e)}return o(n,[{key:"setCreateGameObjectCallback",value:function(t,e){return t&&"sprite"!==t?"image"===t&&(t=ke):t=ye,g(f(n.prototype),"setCreateGameObjectCallback",this).call(this,t,e),this}}]),n}()),ye=function(t,e,i){return t.add.sprite(0,0,e,i="string"!=typeof i&&"number"!=typeof i?void 0:i)},ke=function(t,e,i){return t.add.image(0,0,e,i="string"!=typeof i&&"number"!=typeof i?void 0:i)},be=(Object.assign(ve.prototype,t),[function(t,s,e){var a=e.name,r=t.getGameObjectManager(a);s.on("+",function(t){var e,i,n;s.skipEventFlag||(e=t.split("."),et(e,a)&&(e=e[1],n=(i=Array.prototype.slice.call(arguments,1)).shift(),r.playAnimation(e,n),0<i.length&&r.chainAnimation(e,i),s.skipEvent()))}).on("+",function(t){var e,i;s.skipEventFlag||(t=t.split("."),i=a,3===(e=t).length&&e[0]===i&&"stop"===e[2]&&(i=t[1],r.stopAnimation(i),s.skipEvent()))}).on("-",function(t){s.skipEventFlag||(t=t.split("."),et(t,a)&&(t=t[1],r.stopAnimation(t),s.skipEvent()))})},function(t,n,e){var s=e.name,a=t.getGameObjectManager(s);n.on("+",function(t){var e,i;n.skipEventFlag||(t=t.split("."),i=s,3===(e=t).length&&e[0]===i&&"pause"===e[2]&&(i=t[1],a.pauseAnimation(i),n.skipEvent()))})},function(t,s,e){var a=e.name,r=t.getGameObjectManager(a);s.on("+",function(t){var e,i,n;s.skipEventFlag||(e=t.split("."),i=a,3===(n=e).length&&n[0]===i&&"chain"===n[2]&&(i=e[1],n=Array.prototype.slice.call(arguments,1),r.chainAnimation(i,n),s.skipEvent()))})}]),Ee=Phaser.GameObjects.Text,Me=function(t){return t instanceof Ee},we=Phaser.GameObjects.BitmapText,Te=function(t){return t instanceof we},Oe=0,Se=1,je=2,R=Phaser.Utils.Objects.GetFastValue,Ce=Phaser.Utils.Objects.GetValue,Pe=function(){l(n,ht);var i=p(n);function n(t,e){return h(this,n),(t=i.call(this,t,e)).timer=null,t.resetFromJSON(e),t}return o(n,[{key:"resetFromJSON",value:function(t){this.setTextWrapEnable(Ce(t,"wrap",!1)),this.setTypeMode(Ce(t,"typeMode",0)),this.setTypingSpeed(Ce(t,"speed",333)),this.setTextCallback=R(t,"setTextCallback",null),this.setTextCallbackScope=R(t,"setTextCallbackScope",null),this.setTypingContent(R(t,"text","")),this.typingIdx=R(t,"typingIdx",0),this.insertIdx=R(t,"insertIdx",null);t=R(t,"elapsed",null);return null!==t&&this.start(void 0,void 0,this.typingIdx,t),this}},{key:"shutdown",value:function(t){this.isShutdown||(this.freeTimer(),g(f(n.prototype),"shutdown",this).call(this,t))}},{key:"setTypeMode",value:function(t){return"string"==typeof t&&(t=Ge[t]),this.typeMode=t,this}},{key:"setTypeSpeed",value:function(t){return this.speed=t,this}},{key:"setTypingSpeed",value:function(t){return this.speed=t,this}},{key:"setTextWrapEnable",value:function(t){return this.textWrapEnable=t=void 0===t?!0:t,this}},{key:"text",get:function(){return this._text},set:function(t){t=xe(t);this.textWrapEnable&&(t=function(t,e){switch(it(t)){case Oe:t.style.syncFont(t.canvas,t.context),e=t.runWordWrap(e);break;case Se:e=t.getText(e,void 0,void 0,!0);break;case je:e=t.setText(e).getTextBounds().wrappedText}return e}(this.parent,t)),this._text=t}},{key:"isTyping",get:function(){return null!==this.getTimer()}},{key:"isLastChar",get:function(){return this.typingIdx===this.textLen}},{key:"start",value:function(t,e,i,n){return void 0!==t&&this.setTypingContent(t),void 0!==e&&(this.speed=e),this.typingIdx=(i=void 0===i?0:i)+1,0===this.speed?this.stop(!0):(this.setText(""),this.startTimer(n)),this}},{key:"appendText",value:function(t){t=this.text.concat(xe(t));return this.isTyping?this.setTypingContent(t):this.start(t,void 0,this.textLen),this}},{key:"stop",value:function(t){return this.getTimer()&&this.freeTimer(),t&&(this.typingIdx=this.textLen,this.setText(this.text),this.emit("type"),this.emit("complete",this,this.parent)),this}},{key:"pause",value:function(){var t=this.getTimer();return t&&(t.paused=!0),this}},{key:"resume",value:function(){var t=this.getTimer();return t&&(t.paused=!1),this}},{key:"setTypingContent",value:function(t){return this.text=t,this.textLen=this.getTextLength(this.text),this}},{key:"onTyping",value:function(){var t=this.getTypingString(this.text,this.typingIdx,this.textLen,this.typeMode);this.setText(t),this.emit("type"),this.isLastChar?(this.freeTimer(),this.emit("complete",this,this.parent)):(this.timer.delay=this.speed,this.typingIdx++)}},{key:"getTypingString",value:function(t,e,i,n){var s,a,r,o;return 0===n?(r=0,this.insertIdx=o=e,s=this.getSubString(t,r,o)):1===n?(r=(o=i)-e,this.insertIdx=0,s=this.getSubString(t,r,o)):2===n?(o=(r=Math.floor(i/2-e/2))+e,this.insertIdx=e%2?e:0,s=this.getSubString(t,r,o)):3===n&&(i=0<(n=Math.floor(e/2))?(r=(o=i)-n,this.getSubString(t,r,o)):"",0<(e=e-n)?(o=(r=0)+e,this.insertIdx=o,a=this.getSubString(t,r,o)):(a="",this.insertIdx=0),s=a+i),s}},{key:"startTimer",value:function(t){return this.timer&&this.freeTimer(),t=void 0===t?0:(this.speed,t),this.timer=this.scene.time.addEvent({delay:1e-4,startAt:t,loop:!0,callback:this.onTyping,callbackScope:this}),this}},{key:"getTimer",value:function(){return this.timer}},{key:"freeTimer",value:function(){return this.timer&&(this.timer.remove(),this.timer=null),this}},{key:"setText",value:function(t){if(this.setTextCallback&&(t=this.setTextCallbackScope?this.setTextCallback.call(this.setTextCallbackScope,t,this.isLastChar,this.insertIdx):this.setTextCallback(t,this.isLastChar,this.insertIdx)),this.textWrapEnable){var e=this.parent,i=t;switch(it(e)){case Oe:var n=(a=e.style).wordWrapWidth,s=a.wordWrapCallback;a.wordWrapWidth=0,a.wordWrapCallback=void 0,e.setText(i),a.wordWrapWidth=n,a.wordWrapCallback=s;break;case Se:var a,n=(a=e.style).wrapMode;a.wrapMode=0,e.setText(i),a.wrapMode=n;break;case je:s=e._maxWidth;e._maxWidth=0,e.setText(i),e._maxWidth=s}}else this.parent.setText(t)}},{key:"getTextLength",value:function(t){var e=this.parent,e=(e.getPlainText?e.getPlainText(t):t).length;return e}},{key:"getSubString",value:function(t,e,i){var n=this.parent,n=n.getSubString?n.getSubString(t,e,i):t.slice(e,i);return n}}]),n}(),xe=function(t){return Array.isArray(t)?t=t.join("\n"):"number"==typeof t&&(t=t.toString()),t},Ge={"left-to-right":0,"right-to-left":1,"middle-to-sides":2,"sides-to-middle":3},Be=function(){l(i,j);var t=p(i);function i(){return h(this,i),t.apply(this,arguments)}return o(i,[{key:"setGO",value:function(t,e){return g(f(i.prototype),"setGO",this).call(this,t,e),t.setData("typing",!0),this}},{key:"clearText",value:function(){return this.gameObject.setText(""),this}},{key:"appendText",value:function(t){return this.gameObject.setText(this.gameObject.text+t),this}},{key:"setTypingSpeed",value:function(t){var e=this.gameObject;return e.typing||(e.typing=new Pe(e)),e.typing.setTypingSpeed(t),this}},{key:"clearTyping",value:function(){var t=this.gameObject;return t.typing?t.typing.start(""):t.typing=new Pe(t),this}},{key:"typing",value:function(t,e){var i=this.gameObject;return i.typing||(i.typing=new Pe(i)),void 0!==e&&i.typing.setTypingSpeed(e),i.setData("typing",!1),i.typing.once("complete",function(){i.setData("typing",!0)}).appendText(t),this}}]),i}(),e={},De=(Object.assign(e,{clearText:function(t){return this.has(t)&&this.get(t).clearText(),this},appendText:function(t,e){return this.has(t)&&this.get(t).appendText(e),this},clearTyping:function(t){return this.has(t)&&this.get(t).clearTyping(),this},typing:function(t,e){return this.has(t)&&this.get(t).typing(e),this},appendTyping:function(t,e){return this.has(t)&&this.get(t).appendTyping(e),this},setTypingSpeed:function(t,e){return this.has(t)&&this.get(t).setTypingSpeed(e),this}}),function(){l(n,D);var i=p(n);function n(t,e){return h(this,n),(e=void 0===e?{}:e).BobClass=Be,i.call(this,t,e)}return o(n,[{key:"setCreateGameObjectCallback",value:function(t,e){return t&&"text"!==t||(t=Re),g(f(n.prototype),"setCreateGameObjectCallback",this).call(this,t,e),this}}]),n}()),Re=function(t){return t.add.text(0,0,"")},Fe=(Object.assign(De.prototype,e),[function(t,e,i){var i=i.name,n=t.getGameObjectManager(i);t.on("".concat(i,".text"),function(e){n.clearText(e),t.setContentCallback(function(t){n.appendText(e,t)})})},function(t,e,i){var i=i.name,n=t.getGameObjectManager(i);t.on("".concat(i,".typing"),function(e,i){n.clearTyping(e),t.setContentCallback(function(t){void 0!==i&&n.setTypingSpeed(e,i),n.typing(e,t)})})}]),_e={to:!0,yoyo:!0,from:!0,toLeft:!0,toRight:!0,toUp:!0,toDown:!0,yoyoLeft:!0,yoyoRight:!0,yoyoUp:!0,yoyoDown:!0,fromLeft:!0,fromRight:!0,fromUp:!0,fromDown:!0},Ve=[function(t,a,e){var r=e.name,o=t.getGameObjectManager(r);a.on("+",function(t){if(!a.skipEventFlag){var e=t.split(".");if(nt(e,r)){for(var e=e[1],i=arguments.length,n=new Array(1<i?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];o.add.apply(o,[e].concat(n)),a.skipEvent()}}}).on("-",function(t){a.skipEventFlag||(t=t.split("."),nt(t,r)&&(t=t[1],o.remove(t),a.skipEvent()))})},function(t,e,i){var n=i.name,s=t.getGameObjectManager(n);e.on("-",function(t){e.skipEventFlag||t===n&&(s.removeAll(),e.skipEvent())})},function(o,u,t){var c=t.name,h=o.getGameObjectManager(c);u.on("+",function(t){if(!u.skipEventFlag){var e=t.split(".");if(n=c,3===(i=e).length&&i[0]===n){for(var i=e[1],n=e[2],e="".concat(c,".").concat(n),s=arguments.length,a=new Array(1<s?s-1:0),r=1;r<s;r++)a[r-1]=arguments[r];o.emit.apply(o,[e,i].concat(a)),0<o.listenerCount(e)||(h.hasMethod(i,n)?h.call.apply(h,[i,n].concat(a)):h.setProperty(i,n,a[0])),u.skipEvent()}}})},function(t,u,e){var c=e.name,h=t.getGameObjectManager(c);u.on("+",function(t,e,i,n,s){var a,r,o;u.skipEventFlag||(t=t.split("."),r=c,4===(o=t).length&&o[0]===r&&_e[o[3]]&&(r=t[1],o=t[2],"number"==typeof(a=h.getProperty(r,o)))&&("number"==typeof n&&(s=n,n=void 0),(t=t[3]).endsWith("Left")||t.endsWith("Up")?t.startsWith("to")||t.startsWith("yoyo")?e=a-e:t.startsWith("from")&&(h.setProperty(r,o,a-e),e=a):t.endsWith("Right")||t.endsWith("Down")?t.startsWith("to")||t.startsWith("yoyo")?e=a+e:t.startsWith("from")&&(h.setProperty(r,o,a+e),e=a):"from"===t&&(h.setProperty(r,o,e),e=a),a=t.startsWith("yoyo"),h.easeProperty(r,o,e,i,n,s,a),u.skipEvent()))})}],Le=ie.addGameObjectManager,Ie=function(t){switch(t){case"camera.fadein":case"camera.fadeout":case"camera.flash":case"camera.shake":case"camera.zoom":case"camera.rotate":case"camera.scroll":return!0;default:return!1}},Ae=function(t,e){e=e.split(".");return t.gameObjectManagers.hasOwnProperty(e[0])},We=function(t,e,i,n){var s=t.waitEventManager,a=e.split("."),r=a[0],o=t.getGameObjectManager(r),u="wait.".concat(r);switch(a.length){case 1:return s.waitGameObjectManagerEmpty(r),void t.emit(u);case 2:var c=a[1];return s.waitGameObjectDestroy(r,c),void t.emit(u,c);case 3:var c=a[1],h=a[2];if("number"==typeof o.getProperty(c,h))return s.waitGameObjectTweenComplete(r,c,h),void t.emit(u,c,h);var l=h.startsWith("!");l&&(h=h.substring(1)),o.hasData(c,h)?(s.waitGameObjectDataFlag(r,c,h,!l),t.emit(u,c,h)):s.waitTime(0)}},Ne=Phaser.Input.Keyboard.KeyCodes,F=Phaser.Data.DataManager,S={setClickTarget:function(t){return(this.clickTarget=t)?a(t)?this.clickEE=t.input:this.clickEE=t.setInteractive():this.clickEE=null,this},setTargetCamera:function(t){return this.targetCamera=t,this},setSkipSoundEffect:function(t){return(this.skipSoundEffect=t=void 0===t?!0:t)&&(t=this._soundManager)&&t.fadeOutAllSoundEffects(100,!0),this},wait:function(t){if(!this.ignoreWait){this.pause();var e=this,i=t,t=this.resume,n=this,s=e.waitEventManager;s.clearWaitCompleteCallbacks().addWaitCompleteCallback(t,n);for(var a=0,r=(i="string"==typeof i&&1<i.length&&-1!==i.indexOf("|")?i.split("|"):[i]).length;a<r;a++){var o,u,c=i[a];null==c||"wait"===c?(u=e.waitEventManager.getWaitCompleteTriggerCallback(),e.emit("wait",u)):"number"!=typeof c&&isNaN(c)?"click"===c?(s.waitClick(),e.emit("wait.click")):"se"===c?(s.waitSoundEffectComplete(),o=e.soundManager.getLastSoundEffect(),e.emit("wait.music",o)):"se2"===c?(s.waitSoundEffect2Complete(),o=e.soundManager.getLastSoundEffect2(),e.emit("wait.music",o)):"bgm"===c?(s.waitBackgroundMusicComplete(),o=e.soundManager.getBackgroundMusic(),e.emit("wait.music",o)):"bgm2"===c?(s.waitBackgroundMusic2Complete(),o=e.soundManager.getBackgroundMusic2(),e.emit("wait.music",o)):Ne.hasOwnProperty(c.toUpperCase())?(s.waitKeyDown(c),e.emit("wait.keydown",c)):Ie(c)?(s.waitCameraEffectComplete(c),e.emit("wait.camera",c)):Ae(e,c)?We(e,c):(u=e.waitEventManager.getWaitCompleteTriggerCallback(),e.emit("wait.".concat(c),u)):(c=parseFloat(c),s.waitTime(c),e.emit("wait.time",c))}}return this}},Ue=(Object.assign(S,{play:function(t){return this.parser.start(t),this},playPromise:function(t){var e=st(this);return this.play(t),e}},{pause:function(){return this.parser.pause(),this},pauseUntilEvent:function(t,e){return this.parser.pauseUntilEvent(t,e),this}},{resume:function(){return this.parser.next(),this}},{addGameObjectManager:function(t,e){(t=void 0===t?{}:t).name||console.warn("Parameter 'name' is required in TagPlayer.addGameObjectManager(config) method"),Le.call(this,t,e);for(var i=t.parseCallbacks,n=0,s=(i=i?[].concat(u(i),Ve):Ve).length;n<s;n++)i[n](this,this.parser,t);return this}},{getSprite:function(t){return this.getGameObject("sprite",t)},addSprite:function(t,e){return this.addGameObject("sprite",t,e),this}},{getTextGameObject:function(t){return this.getGameObject("text",t)},addTextGameObject:function(t,e){return this.addGameObject("text",t,e),this}},{setContentCallback:function(t,e){return this.contentCallback=t,this.contentCallbackScope=e,this}},{destroyDataManager:function(){this.data&&(this.data.destroy(),this.data=void 0)},setDataEnabled:function(){return this.data||(this.data=new F(this)),this},setData:function(t,e){return this.data||(this.data=new F(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new F(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new F(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new F(this)),this.data.get(t)}}),Phaser.Events.EventEmitter),Je=Phaser.Utils.Objects.GetValue,ze=function(){l(s,Q(Ue));var n=p(s);function s(t,e){h(this,s),void 0===e&&(e={}),(i=n.call(this)).scene=t,i.initManagers(t,e),i.parser=new ge(d(i),Je(e,"parser",void 0));var i,t=Je(e,"sprites"),t=(!1!==t&&null!==t&&!function(t){(t=void 0===t?{}:t).name="sprite",t.parseCallbacks=be,this.addGameObjectManager(t,ve)}.call(d(i),t),Je(e,"texts"));return!1!==t&&null!==t&&function(t){(t=void 0===t?{}:t).name="text",t.parseCallbacks=Fe,this.addGameObjectManager(t,De)}.call(d(i),t),i}return o(s,[{key:"isPlaying",get:function(){return this.parser.isRunning}},{key:"targetCamera",get:function(){return this.waitEventManager.targetCamera}},{key:"clickTarget",get:function(){return this.waitEventManager.clickTarget}},{key:"spriteManager",get:function(){return this.getGameObjectManager("sprite")}},{key:"textManager",get:function(){return this.getGameObjectManager("text")}},{key:"gameObjectManagerNames",get:function(){var t,e=[];for(t in this.gameObjectManagers)e.push(t);return e}},{key:"destroy",value:function(t){this.scene&&(g(f(s.prototype),"destroy",this).call(this),this.destroyManagers(t),this.scene=void 0)}},{key:"timeScale",get:function(){return this.getTimeScale()},set:function(t){this.setTimeScale(t)}}]),s}();return Object.assign(ze.prototype,S),function(){l(i,Phaser.Plugins.BasePlugin);var e=p(i);function i(t){return h(this,i),e.call(this,t)}return o(i,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"add",value:function(t,e){return new ze(t,e)}}]),i}()});
